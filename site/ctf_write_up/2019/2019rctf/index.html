



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://blog.alikas.cf/ctf_write_up/2019/2019rctf/">
      
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="ja">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="https://raw.githubusercontent.com/Alikas0/files/master/videos/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>2019 RCTF国际赛 - Alikas|station</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.0284f74d.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.01803549.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#babyre1" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://blog.alikas.cf" title="Alikas|station" class="md-header-nav__button md-logo">
          
            <i class="md-icon">border_color</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Alikas|station
            </span>
            <span class="md-header-nav__topic">
              
                2019 RCTF国际赛
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/Alikas0/Alikas0.github.io/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Alikas0.github.io
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://blog.alikas.cf" title="Alikas|station" class="md-nav__button md-logo">
      
        <i class="md-icon">border_color</i>
      
    </a>
    Alikas|station
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/Alikas0/Alikas0.github.io/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Alikas0.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Homepage
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Homepage
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../.." title="主页" class="md-nav__link">
      主页
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../links/" title="友情链接" class="md-nav__link">
      友情链接
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      CTF Write-Up
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        CTF Write-Up
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1">
    
    <label class="md-nav__link" for="nav-2-1">
      2018
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        2018
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../2018/2018rctf/" title="2018 RCTF" class="md-nav__link">
      2018 RCTF
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2" checked>
    
    <label class="md-nav__link" for="nav-2-2">
      2019
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        2019
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../2019aurora/" title="2019 Aurora内部赛" class="md-nav__link">
      2019 Aurora内部赛
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        2019 RCTF国际赛
      </label>
    
    <a href="./" title="2019 RCTF国际赛" class="md-nav__link md-nav__link--active">
      2019 RCTF国际赛
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#babyre1" title="babyre1" class="md-nav__link">
    babyre1
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#babyre2" title="babyre2" class="md-nav__link">
    babyre2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#donteatme" title="DontEatMe" class="md-nav__link">
    DontEatMe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crack" title="crack" class="md-nav__link">
    crack
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" title="第一部分" class="md-nav__link">
    第一部分
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" title="第二部分" class="md-nav__link">
    第二部分
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../2019starctf/" title="2019 *CTF" class="md-nav__link">
      2019 *CTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../2019qwb/" title="2019 强网杯" class="md-nav__link">
      2019 强网杯
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      Exams
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        Exams
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3-1" type="checkbox" id="nav-2-3-1">
    
    <label class="md-nav__link" for="nav-2-3-1">
      BUUCTF
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-3-1">
        BUUCTF
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/buuctf/introduction/" title="简介" class="md-nav__link">
      简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/buuctf/misc/" title="MISC" class="md-nav__link">
      MISC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/buuctf/reverse/" title="Reverse" class="md-nav__link">
      Reverse
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3-2" type="checkbox" id="nav-2-3-2">
    
    <label class="md-nav__link" for="nav-2-3-2">
      旧版Bugku
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-3-2">
        旧版Bugku
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/old_bugku/introduction/" title="简介" class="md-nav__link">
      简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/old_bugku/reverse/" title="Reverse" class="md-nav__link">
      Reverse
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3-3" type="checkbox" id="nav-2-3-3">
    
    <label class="md-nav__link" for="nav-2-3-3">
      实验吧
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-3-3">
        实验吧
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/shiyanba/introduction/" title="简介" class="md-nav__link">
      简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/shiyanba/reverse/" title="Reverse" class="md-nav__link">
      Reverse
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      CTF Tools
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        CTF Tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_tools/xortool/" title="Xortool" class="md-nav__link">
      Xortool
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_tools/ida_python/" title="IDA python" class="md-nav__link">
      IDA python
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      MISC
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        MISC
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/python_script/" title="python脚本" class="md-nav__link">
      python脚本
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/big_little_ending/" title="大端序和小端序" class="md-nav__link">
      大端序和小端序
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      提问的智慧
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        提问的智慧
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/introduction/" title="简介" class="md-nav__link">
      简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/before_you_ask/" title="在提问之前" class="md-nav__link">
      在提问之前
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/when_you_ask/" title="当你在提问时" class="md-nav__link">
      当你在提问时
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/how_to_interpret_answers/" title="如何解读答案" class="md-nav__link">
      如何解读答案
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/on_not_reacting_like_loser/" title="如何避免扮演失败者" class="md-nav__link">
      如何避免扮演失败者
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/questions_not_to_ask/" title="不该问的问题" class="md-nav__link">
      不该问的问题
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/good_and_bad_questions/" title="好问题与蠢问题" class="md-nav__link">
      好问题与蠢问题
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/if_you_cant_get_an_answer/" title="如果得不到回答" class="md-nav__link">
      如果得不到回答
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/how_to_answer_questions_in_a_helpful_way/" title="如何更好地回答问题" class="md-nav__link">
      如何更好地回答问题
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/how_to_ask_questions_the_smart_way/" title="完整版" class="md-nav__link">
      完整版
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      Install WSL
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        Install WSL
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/wsl/install/" title="安装" class="md-nav__link">
      安装
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/wsl/mklink/" title="mklink软链接到非系统盘" class="md-nav__link">
      mklink软链接到非系统盘
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/wsl/optimization/" title="子系统优化" class="md-nav__link">
      子系统优化
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/wsl/questions/" title="杂七杂八问题" class="md-nav__link">
      杂七杂八问题
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/wsl/reference/" title="参考资料" class="md-nav__link">
      参考资料
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#babyre1" title="babyre1" class="md-nav__link">
    babyre1
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#babyre2" title="babyre2" class="md-nav__link">
    babyre2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#donteatme" title="DontEatMe" class="md-nav__link">
    DontEatMe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crack" title="crack" class="md-nav__link">
    crack
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" title="第一部分" class="md-nav__link">
    第一部分
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" title="第二部分" class="md-nav__link">
    第二部分
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/Alikas0/Alikas0.github.io/edit/master/docs/ctf_write_up/2019/2019rctf.md" title="编辑此页" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>2019 RCTF国际赛</h1>
                
                <p>赛后复现，学习学习！
嗯,主办方很喜欢XXTEA呀0.0</p>
<h2 id="babyre1">babyre1</h2>
<p>题目：<a href="https://raw.githubusercontent.com/Alikas0/CTF/master/challenges/2019/RCTF/babyre.zip">babyre1</a></p>
<p>运行：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>Input right flag you can got &#39;Bingo!&#39; :ssssss
input is too short!
</pre></div>
</td></tr></table>

<p>IDA打开，找到主函数：</p>
<p>分析得：输入密文,长度为16，范围0-9，a-z</p>
<p>之后用xxtea解密，后进行CRC16_CCITT校验，结果应该等于0x69E2。而后对解密后的前N位异或0x17，根据提示，最终应该得到Bingo!。</p>
<p>而xxtea解密中：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">v11</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">v8</span><span class="p">[</span><span class="n">v6</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
        <span class="n">v8</span><span class="p">[</span><span class="n">v6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="o">*</span><span class="n">v5</span> <span class="o">=</span> <span class="n">v6</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">v6</span> <span class="o">&gt;</span> <span class="n">v11</span> <span class="o">&amp;&amp;</span> <span class="n">v11</span> <span class="o">&lt;=</span> <span class="mi">4</span> <span class="p">)</span>
        <span class="p">{</span>
          <span class="n">v13</span> <span class="o">=</span> <span class="n">v6</span> <span class="o">-</span> <span class="n">v11</span><span class="p">;</span>
          <span class="o">*</span><span class="n">v5</span> <span class="o">=</span> <span class="n">v13</span><span class="p">;</span>
          <span class="n">v8</span><span class="p">[</span><span class="n">v13</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="k">return</span> <span class="n">v8</span><span class="p">;</span>
        <span class="p">}</span>
</pre></div>
</td></tr></table>

<p>根据解密的最后一个字节的大小N，把明文倒数第N位用"\0"截断。</p>
<p>那么最后一个字节的大小就应该为2，即最终应该为<code>“Bingo!xx\x02”</code>,xx未知，而<code>Bingo！</code>应异或0x17.</p>
<p>可以通过提示：<code>MD5(rctf{your answer}) == 5f8243a662cf71bf31d2b2602638dc1d</code>爆破出来。</p>
<p>而我这里是靠猜的，也不难猜，\x02很像加密时的padding，所以猜测XXTEA解密后的明文应该为<code>“Bingo!\x02\x02”</code>(其中Bingo！应为异或0x17后的结果)</p>
<p>则解密脚本如下（XXTEA代码网上抄的0.0）：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp"></span>

<span class="n">using</span> <span class="n">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="cp">#define DELTA 0x9e3779b9</span>
<span class="cp">#define MX (((z &gt;&gt; 5 ^ y &lt;&lt; 2) + (y &gt;&gt; 3 ^ z &lt;&lt; 4)) ^ ((sum ^ y) + (key[(p &amp; 3) ^ e] ^ z)))</span>

<span class="kt">void</span> <span class="nf">btea</span><span class="p">(</span><span class="kt">uint32_t</span> <span class="o">*</span><span class="n">v</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="k">const</span> <span class="n">key</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="p">{</span>
    <span class="kt">uint32_t</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">sum</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="n">p</span><span class="p">,</span> <span class="n">rounds</span><span class="p">,</span> <span class="n">e</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="cm">/* Coding Part */</span>
    <span class="p">{</span>
        <span class="n">rounds</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">52</span> <span class="o">/</span> <span class="n">n</span><span class="p">;</span>
        <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
        <span class="k">do</span>
        <span class="p">{</span>
            <span class="n">sum</span> <span class="o">+=</span> <span class="n">DELTA</span><span class="p">;</span>
            <span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="n">sum</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">p</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">p</span><span class="o">++</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
                <span class="n">z</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">+=</span> <span class="n">MX</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">MX</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="o">--</span><span class="n">rounds</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="cm">/* Decoding Part */</span>
    <span class="p">{</span>
        <span class="n">n</span> <span class="o">=</span> <span class="o">-</span><span class="n">n</span><span class="p">;</span>
        <span class="n">rounds</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">52</span> <span class="o">/</span> <span class="n">n</span><span class="p">;</span>
        <span class="n">sum</span> <span class="o">=</span> <span class="n">rounds</span> <span class="o">*</span> <span class="n">DELTA</span><span class="p">;</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="k">do</span>
        <span class="p">{</span>
            <span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="n">sum</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">p</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="n">p</span><span class="o">--</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">z</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">-=</span> <span class="n">MX</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">MX</span><span class="p">;</span>
            <span class="n">sum</span> <span class="o">-=</span> <span class="n">DELTA</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="o">--</span><span class="n">rounds</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">decode</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">cipher</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">char</span> <span class="n">chr1</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">;</span>
        <span class="kt">char</span> <span class="n">chr2</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">chr1</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span>
            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="kt">char</span><span class="p">(</span><span class="n">chr1</span> <span class="o">+</span> <span class="mh">0x30</span><span class="p">);</span>
        <span class="k">else</span>
            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="kt">char</span><span class="p">(</span><span class="n">chr1</span> <span class="o">+</span> <span class="mh">0x61</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span> <span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">chr2</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span>
            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="kt">char</span><span class="p">(</span><span class="n">chr2</span> <span class="o">+</span> <span class="mh">0x30</span><span class="p">);</span>
        <span class="k">else</span> 
            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="kt">char</span><span class="p">(</span><span class="n">chr2</span> <span class="o">+</span> <span class="mh">0x61</span> <span class="o">-</span> <span class="mi">10</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">uint32_t</span> <span class="n">cipher</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">};</span>
    <span class="kt">char</span> <span class="n">cipher1</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;Bingo!</span><span class="se">\x02\x02</span><span class="s">&quot;</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">uint32_t</span> <span class="n">key</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span> <span class="mh">0xE0C7E0C7</span><span class="p">,</span> <span class="mh">0xC6F1D3D7</span><span class="p">,</span><span class="mh">0xC6D3C6D3</span><span class="p">,</span><span class="mh">0xC4D0D2CE</span> <span class="p">};</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">cipher1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="mh">0x17</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">memcpy</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span><span class="n">cipher1</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span>
    <span class="n">btea</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">key</span><span class="p">);</span>


    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;rctf{&quot;</span><span class="p">;</span>
    <span class="n">decode</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">cipher</span><span class="p">);</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;}&quot;</span><span class="p">;</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>得到flag：</p>
<p>rctf{05e8a376e4e0446e}</p>
<h2 id="babyre2">babyre2</h2>
<p>题目：<a href="https://raw.githubusercontent.com/Alikas0/CTF/master/challenges/2019/RCTF/babyre2.zip">babyre2</a></p>
<p>程序逻辑：</p>
<p>输入8-16位长account，8-16位长password，不超过0x400长度的data，data范围：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="sc">&#39;/&#39;</span> <span class="o">||</span> <span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="sc">&#39;9&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="sc">&#39;`&#39;</span> <span class="o">||</span> <span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="sc">&#39;f&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="sc">&#39;@&#39;</span> <span class="o">||</span> <span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="sc">&#39;F&#39;</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</td></tr></table>

<p>后以account作为key，加密一组常量。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span> <span class="n">v12</span> <span class="o">=</span> <span class="n">XXtea_1</span><span class="p">((</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">account</span><span class="p">,</span> <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v6</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>0xF8u,0xD4u,0xD5u,0xDCu,0xC9u,0xDAu,0xCFu,0xCEu,0xD7u,0xDAu,0xCFu,0xD2u,0xD4u,0xD5u,0xC8u,0x9Au,0xB1u
</pre></div>
</td></tr></table>

<p>password的每一位减去十位和个位，减去的结果作为下标从data取数据，得到data2.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span> <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">v10</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
            <span class="p">{</span>
              <span class="n">v11</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10</span><span class="p">);</span>
              <span class="k">if</span> <span class="p">(</span> <span class="n">v11</span> <span class="o">&gt;=</span> <span class="n">v6</span> <span class="p">)</span>
              <span class="p">{</span>
                <span class="n">v8</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
              <span class="p">}</span>
              <span class="n">ptr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v11</span> <span class="o">+</span> <span class="n">a2</span><span class="p">);</span>
            <span class="p">}</span>
</pre></div>
</td></tr></table>

<p>用data2异或0xCC作为key密之前的密文。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">a2</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
    <span class="o">*</span><span class="p">((</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">dest</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span> <span class="o">^=</span> <span class="mh">0xCCu</span><span class="p">;</span>
  <span class="n">ptr</span> <span class="o">=</span> <span class="n">XXTEA_2</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="n">v7</span><span class="p">,</span> <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">dest</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dword_204058</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p>于是直接构造account:'1'*16，data'fd'*256，password任意16位即可</p>
<p>脚本：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./babyre2&#39;</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Please input the account:&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Please input the password:&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Please input the data:&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;fd&#39;</span><span class="o">*</span><span class="mi">256</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>

<span class="c1"># print(hex(0x31 ^ 0xCC))</span>
</pre></div>
</td></tr></table>

<p>p.s.这题还有时间限制,调试的时候就很喜欢Time Out!0.0....</p>
<h2 id="donteatme">DontEatMe</h2>
<p>题目：<a href="https://raw.githubusercontent.com/Alikas0/CTF/master/challenges/2019/RCTF/DontEatMe.zip">DontEatMe</a></p>
<p>运行程序：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>LiHua is trapped on an isolated island. One day, he caught a fish.
Suddenly,the fish said: &quot;Dont eat me! I am Fish God,if you release me,as return ,you have one wish.&quot;
Li said : I want to know how to escape from this island.
Fish said:
</pre></div>
</td></tr></table>

<p>根据输出找到主函数，一开始有ZwSetInformationThread反调试：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">v70</span> <span class="o">=</span> <span class="n">GetModuleHandleA</span><span class="p">(</span><span class="s">&quot;Ntdll&quot;</span><span class="p">);</span>
<span class="n">v71</span> <span class="o">=</span> <span class="n">GetProcAddress</span><span class="p">(</span><span class="n">v70</span><span class="p">,</span> <span class="s">&quot;ZwSetInformationThread&quot;</span><span class="p">);</span>
<span class="n">v72</span> <span class="o">=</span> <span class="n">GetCurrentThread</span><span class="p">();</span>
</pre></div>
</td></tr></table>

<p>直接跳过就可以了，伪随机数生成以一串key，接下来应该是那个函数应该是Blowfish</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span> <span class="n">srand</span><span class="p">(</span><span class="mh">0xDEADBEEF</span><span class="p">);</span>
 <span class="p">.....</span>
 <span class="k">do</span>
    <span class="n">key</span><span class="p">[</span><span class="n">v6</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">rand</span><span class="p">();</span>
 <span class="k">while</span> <span class="p">(</span> <span class="n">v6</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="p">);</span>
 <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
 <span class="n">v56</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)</span><span class="s">&quot;fishFISH&quot;</span><span class="p">;</span>
 <span class="o">*</span><span class="p">(</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)</span><span class="s">&quot;fishFISH&quot;</span> <span class="o">^</span> <span class="o">*</span><span class="p">(</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v56</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
 <span class="o">*</span><span class="p">(</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">key</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v56</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">^</span> <span class="o">*</span><span class="p">(</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v56</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span>
 <span class="o">*</span><span class="p">(</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">key</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">WORD1</span><span class="p">(</span><span class="n">v56</span><span class="p">)</span> <span class="o">^</span> <span class="o">*</span><span class="p">(</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v56</span> <span class="o">+</span> <span class="mi">5</span><span class="p">);</span>
<span class="n">key</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">BYTE3</span><span class="p">(</span><span class="n">v56</span><span class="p">)</span> <span class="o">^</span> <span class="n">aFishfish</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
<span class="n">Blowfish</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v49</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p>特征为：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nl">.rdata:</span><span class="err">000</span><span class="nf">B3118</span> <span class="no">dword_B3118</span>     <span class="no">dd</span> <span class="mi">243</span><span class="no">F6A88h</span>            <span class="c">; DATA XREF: Blowfish+12↑o</span>
<span class="nl">.rdata:</span><span class="err">000</span><span class="nf">B311C</span>                 <span class="no">dd</span> <span class="mi">85</span><span class="no">A308D3h</span>
<span class="nl">.rdata:</span><span class="err">000</span><span class="nf">B3120</span>                 <span class="no">dd</span> <span class="mi">13198</span><span class="no">A2Eh</span>
<span class="nl">.rdata:</span><span class="err">000</span><span class="nf">B3124</span>                 <span class="no">dd</span> <span class="mi">3707344</span><span class="no">h</span>
<span class="nl">.rdata:</span><span class="err">000</span><span class="nf">B3128</span>                 <span class="no">dd</span> <span class="mi">0</span><span class="no">A4093822h</span>
<span class="nl">.rdata:</span><span class="err">000</span><span class="nf">B312C</span>                 <span class="no">dd</span> <span class="mi">299</span><span class="no">F31D0h</span>
<span class="nl">.rdata:</span><span class="err">000</span><span class="nf">B3130</span>                 <span class="no">dd</span> <span class="mi">82</span><span class="no">EFA98h</span>
<span class="nl">.rdata:</span><span class="err">000</span><span class="nf">B3134</span>                 <span class="no">dd</span> <span class="mi">0</span><span class="no">EC4E6C89h</span>
<span class="nl">.rdata:</span><span class="err">000</span><span class="nf">B3138</span>                 <span class="no">dd</span> <span class="mi">452821</span><span class="no">E6h</span>
<span class="nl">.rdata:</span><span class="err">000</span><span class="nf">B313C</span>                 <span class="no">dd</span> <span class="mi">38</span><span class="no">D01377h</span>
<span class="nl">.rdata:</span><span class="err">000</span><span class="nf">B3140</span>                 <span class="no">dd</span> <span class="mi">0</span><span class="no">BE5466CFh</span>
<span class="nl">.rdata:</span><span class="err">000</span><span class="nf">B3144</span>                 <span class="no">dd</span> <span class="mi">34</span><span class="no">E90C6Ch</span>
<span class="nl">.rdata:</span><span class="err">000</span><span class="nf">B3148</span>                 <span class="no">dd</span> <span class="mi">0</span><span class="no">C0AC29B7h</span>
<span class="nl">.rdata:</span><span class="err">000</span><span class="nf">B314C</span>                 <span class="no">dd</span> <span class="mi">0</span><span class="no">C97C50DDh</span>
<span class="nl">.rdata:</span><span class="err">000</span><span class="nf">B3150</span>                 <span class="no">dd</span> <span class="mi">3</span><span class="no">F84D5B5h</span>
<span class="nl">.rdata:</span><span class="err">000</span><span class="nf">B3154</span>                 <span class="no">dd</span> <span class="mi">0</span><span class="no">B5470917h</span>
<span class="nl">.rdata:</span><span class="err">000</span><span class="nf">B3158</span>                 <span class="no">dd</span> <span class="mi">9216</span><span class="no">D5D9h</span>
<span class="nl">.rdata:</span><span class="err">000</span><span class="nf">B315C</span>                 <span class="no">dd</span> <span class="mi">8979</span><span class="no">FB1Bh</span>
</pre></div>
</td></tr></table>

<p>接下来这里，无论输什么，运算后v8 = 8。所以else里面那一大串都可以不用看hhh</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">if</span> <span class="p">(</span> <span class="n">v8</span> <span class="o">/</span> <span class="mi">16</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v25</span> <span class="o">=</span> <span class="n">envpa</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">v12</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="p">)(</span><span class="n">v9</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span>
    <span class="p">.....</span>
  <span class="p">}</span>
</pre></div>
</td></tr></table>

<p>接下来大一串，就为了生成一个迷宫</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="codehilite"><pre><span></span> <span class="n">a68</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)</span><span class="s">&quot;DontEatM&quot;</span><span class="p">;</span>
  <span class="n">v93</span> <span class="o">=</span> <span class="n">_byteswap_ushort</span><span class="p">(</span><span class="n">aDonteatm</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
  <span class="n">v94</span> <span class="o">=</span> <span class="n">_byteswap_ushort</span><span class="p">(</span><span class="n">WORD1</span><span class="p">(</span><span class="n">a68</span><span class="p">));</span>
  <span class="n">v95</span> <span class="o">=</span> <span class="n">_byteswap_ushort</span><span class="p">(</span><span class="n">aDonteatm</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
  <span class="n">v96</span> <span class="o">=</span> <span class="n">_byteswap_ushort</span><span class="p">(</span><span class="n">aDonteatm</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
  <span class="n">v97</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">byte_3F501A</span><span class="p">;</span>
  <span class="k">do</span>
  <span class="p">{</span>
    <span class="o">*</span><span class="p">((</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)</span><span class="n">v97</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">^=</span> <span class="n">v93</span><span class="p">;</span>
    <span class="o">*</span><span class="p">(</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)</span><span class="n">v97</span> <span class="o">^=</span> <span class="n">v94</span><span class="p">;</span>
    <span class="o">*</span><span class="p">((</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)</span><span class="n">v97</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">^=</span> <span class="n">v95</span><span class="p">;</span>
    <span class="o">*</span><span class="p">((</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)</span><span class="n">v97</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">^=</span> <span class="n">v96</span><span class="p">;</span>
    <span class="n">v97</span> <span class="o">+=</span> <span class="mi">8</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">while</span> <span class="p">(</span> <span class="p">(</span><span class="kt">signed</span> <span class="kt">int</span><span class="p">)</span><span class="n">v97</span> <span class="o">&lt;</span> <span class="p">(</span><span class="kt">signed</span> <span class="kt">int</span><span class="p">)</span><span class="o">&amp;</span><span class="n">unk_3F503A</span> <span class="p">);</span>
  <span class="n">v98</span> <span class="o">=</span> <span class="n">maze</span><span class="p">;</span>
  <span class="n">v99</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int16</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">unk_3F5018</span><span class="p">;</span>
  <span class="k">do</span>
  <span class="p">{</span>
    <span class="n">v100</span> <span class="o">=</span> <span class="o">*</span><span class="n">v99</span><span class="p">;</span>
    <span class="n">v101</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
    <span class="k">do</span>
    <span class="p">{</span>
      <span class="n">v102</span> <span class="o">=</span> <span class="p">(</span><span class="n">v100</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">v101</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="n">v101</span><span class="p">;</span>
      <span class="o">--</span><span class="n">v101</span><span class="p">;</span>
      <span class="o">*</span><span class="n">v98</span> <span class="o">=</span> <span class="n">v102</span><span class="p">;</span>
      <span class="o">++</span><span class="n">v98</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">while</span> <span class="p">(</span> <span class="n">v101</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="p">);</span>
    <span class="o">++</span><span class="n">v99</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">while</span> <span class="p">(</span> <span class="p">(</span><span class="kt">signed</span> <span class="kt">int</span><span class="p">)</span><span class="n">v99</span> <span class="o">&lt;</span> <span class="p">(</span><span class="kt">signed</span> <span class="kt">int</span><span class="p">)</span><span class="o">&amp;</span><span class="n">unk_3F5038</span> <span class="p">);</span>
</pre></div>
</td></tr></table>

<p>大概长这样：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>1111111111111111
1000000000111111
1011111110111111
1011111110111111
1011110000000111
1011110111110111
1011110111110111
1011110000110111
1011111110110111
1011111110110111
1000000000110111
1111101111110111
1111100000000111
1111111111111111
1111111111111111
1111111111111111
</pre></div>
</td></tr></table>

<p>根据<code>maze</code>和解密后的输入进行check</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre></div></td><td class="code"><div class="codehilite"><pre><span></span> <span class="n">v103</span> <span class="o">=</span> <span class="o">*</span><span class="n">v92</span><span class="p">;</span>
  <span class="n">v104</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="n">v105</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v106</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="n">v92</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v107</span> <span class="o">=</span> <span class="mi">160</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="k">switch</span> <span class="p">(</span> <span class="n">v103</span> <span class="p">)</span>
      <span class="p">{</span>
        <span class="k">case</span> <span class="sc">&#39;a&#39;</span><span class="o">:</span>
          <span class="o">--</span><span class="n">v106</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="sc">&#39;d&#39;</span><span class="o">:</span>
          <span class="o">++</span><span class="n">v106</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="sc">&#39;s&#39;</span><span class="o">:</span>
          <span class="o">++</span><span class="n">v104</span><span class="p">;</span>
          <span class="n">v107</span> <span class="o">+=</span> <span class="mi">16</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="sc">&#39;w&#39;</span><span class="o">:</span>
          <span class="o">--</span><span class="n">v104</span><span class="p">;</span>
          <span class="n">v107</span> <span class="o">-=</span> <span class="mi">16</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">default</span><span class="o">:</span>
          <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">maze</span><span class="p">[</span><span class="n">v107</span> <span class="o">+</span> <span class="n">v106</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="n">v103</span> <span class="o">=</span> <span class="n">v92</span><span class="p">[</span><span class="n">v105</span><span class="o">++</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
      <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v103</span> <span class="p">)</span>
      <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">v104</span> <span class="o">==</span> <span class="mi">4</span> <span class="o">&amp;&amp;</span> <span class="n">v106</span> <span class="o">==</span> <span class="mi">9</span> <span class="o">&amp;&amp;</span> <span class="n">v105</span> <span class="o">&lt;</span> <span class="mi">17</span> <span class="p">)</span>
        <span class="p">{</span>
          <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Congratulations! Here is your flag: RCTF{%s}&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">input</span><span class="p">);</span>
          <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
</pre></div>
</td></tr></table>

<p>直接DFS算出明文：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">maze</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">op</span> <span class="o">=</span> <span class="s2">&quot;adsw&quot;</span>
<span class="n">num</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">num1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">160</span>
<span class="k">def</span> <span class="nf">getop</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">num</span>
    <span class="k">global</span> <span class="n">x</span>
    <span class="k">global</span> <span class="n">y</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="n">op</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">x</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="n">op</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="n">op</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
        <span class="n">num</span>  <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">y</span> <span class="o">+=</span> <span class="mi">16</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="n">op</span><span class="p">[</span><span class="mi">3</span><span class="p">]):</span>
        <span class="n">num</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">y</span> <span class="o">-=</span> <span class="mi">16</span> 

<span class="k">def</span> <span class="nf">recover</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">num</span>
    <span class="k">global</span> <span class="n">x</span>
    <span class="k">global</span> <span class="n">y</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="n">op</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="n">op</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">x</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="n">op</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
        <span class="n">num</span>  <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">y</span> <span class="o">-=</span> <span class="mi">16</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="n">op</span><span class="p">[</span><span class="mi">3</span><span class="p">]):</span>
        <span class="n">num</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">y</span> <span class="o">+=</span> <span class="mi">16</span>

<span class="n">ans</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]</span> 

<span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">num</span>
    <span class="k">global</span> <span class="n">num1</span>
    <span class="k">global</span> <span class="n">x</span>
    <span class="k">global</span> <span class="n">y</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">chr</span><span class="p">,</span><span class="n">ans</span><span class="p">)))</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">ord</span><span class="p">,</span><span class="n">op</span><span class="p">)):</span>
        <span class="n">getop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">ans</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="k">if</span> <span class="n">maze</span><span class="p">[</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">dfs</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">recover</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="n">dfs</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>得到：<code>ddddwwwaaawwwddd</code></p>
<p>最终解密脚本如下：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">Blowfish</span>

<span class="n">key</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x00\x0F\x1A\x01\x35\x3A\x3B\x20</span><span class="s2">&quot;</span>
<span class="n">Cipher</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;ddddwwwaaawwwddd&quot;</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">Blowfish</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="n">plain</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">Cipher</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">hex</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">plain</span><span class="p">))):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span><span class="n">end</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>得flag:
RCTF{db824ef8605c5235b4bbacfa2ff8e087}</p>
<h2 id="crack">crack</h2>
<p>题目：<a href="https://raw.githubusercontent.com/Alikas0/CTF/master/challenges/2019/RCTF/crack.zip">crack</a></p>
<h3 id="_1">第一部分</h3>
<p>根据字符串，找到主要函数：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76</pre></div></td><td class="code"><div class="codehilite"><pre><span></span> <span class="n">v4</span> <span class="o">=</span> <span class="n">v3</span><span class="p">;</span>
  <span class="n">sub_106E558</span><span class="p">(</span><span class="n">v3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
  <span class="n">v5</span> <span class="o">=</span> <span class="n">v4</span><span class="p">[</span><span class="mi">52</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">v5</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">)</span>
    <span class="n">sub_10613E0</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">v5</span> <span class="o">-</span> <span class="mi">12</span><span class="p">));</span>
  <span class="n">v6</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">v4</span><span class="p">[</span><span class="mi">58</span><span class="p">];</span>
  <span class="n">v7</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">v4</span><span class="p">[</span><span class="mi">56</span><span class="p">];</span>
  <span class="n">v4</span><span class="p">[</span><span class="mi">53</span><span class="p">]</span> <span class="o">=</span> <span class="n">v4</span><span class="p">[</span><span class="mi">52</span><span class="p">];</span>
  <span class="n">memset</span><span class="p">(</span><span class="n">v7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">v6</span><span class="p">);</span>
  <span class="n">v8</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">v4</span><span class="p">[</span><span class="mi">52</span><span class="p">]</span> <span class="o">-</span> <span class="mi">12</span><span class="p">);</span>                <span class="c1">// len(input)</span>
  <span class="n">v9</span> <span class="o">=</span> <span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">v4</span><span class="p">[</span><span class="mi">54</span><span class="p">];</span>
  <span class="n">v10</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v11</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v12</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v30</span> <span class="o">=</span> <span class="mh">0x100758E540F</span><span class="n">i64</span><span class="p">;</span>
  <span class="n">v29</span> <span class="o">=</span> <span class="n">v8</span><span class="p">;</span>
  <span class="n">v28</span> <span class="o">=</span> <span class="n">v9</span><span class="p">;</span>
  <span class="n">v27</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v8</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">MessageBoxA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Try Again!&quot;</span><span class="p">,</span> <span class="s">&quot;tip&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="k">do</span>
  <span class="p">{</span>
    <span class="n">v13</span> <span class="o">=</span> <span class="n">v4</span><span class="p">[</span><span class="mi">58</span><span class="p">];</span>                               <span class="c1">// 0x200</span>
                                                <span class="c1">// </span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v12</span> <span class="o">&gt;=</span> <span class="n">v13</span> <span class="p">)</span>                           <span class="c1">// 0x200 * 0x200</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v12</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="p">(</span><span class="n">input</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">v4</span><span class="p">[</span><span class="mi">52</span><span class="p">],</span> <span class="n">v12</span> <span class="o">&gt;</span> <span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">input</span> <span class="o">-</span> <span class="mi">3</span><span class="p">))</span> <span class="p">)</span><span class="c1">// len(input) = *(input-3)</span>
      <span class="n">sub_1061560</span><span class="p">(</span><span class="mh">0x80070057</span><span class="p">);</span>
    <span class="n">v15</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int16</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">input</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">v12</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v15</span> <span class="o">!=</span> <span class="sc">&#39;0&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">v15</span> <span class="o">!=</span> <span class="sc">&#39;1&#39;</span> <span class="p">)</span>
      <span class="k">return</span> <span class="n">MessageBoxA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Input no accept!&quot;</span><span class="p">,</span> <span class="s">&quot;tip&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v15</span> <span class="o">==</span> <span class="sc">&#39;1&#39;</span> <span class="p">)</span>
      <span class="n">v27</span> <span class="o">=</span> <span class="o">++</span><span class="n">v10</span><span class="p">;</span>
    <span class="n">v16</span> <span class="o">=</span> <span class="n">v28</span><span class="p">[</span><span class="n">v10</span> <span class="o">+</span> <span class="n">v12</span> <span class="o">*</span> <span class="n">v13</span><span class="p">];</span>
    <span class="n">v17</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">v30</span> <span class="o">&lt;</span> <span class="n">v16</span><span class="p">;</span>
    <span class="n">LODWORD</span><span class="p">(</span><span class="n">v30</span><span class="p">)</span> <span class="o">=</span> <span class="n">v30</span> <span class="o">-</span> <span class="n">v16</span><span class="p">;</span>
    <span class="n">v10</span> <span class="o">=</span> <span class="n">v27</span><span class="p">;</span>
    <span class="n">v9</span> <span class="o">=</span> <span class="n">v28</span><span class="p">;</span>
    <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v30</span><span class="p">)</span> <span class="o">-=</span> <span class="n">v17</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v12</span> <span class="o">&gt;</span> <span class="n">v27</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">v11</span><span class="p">[</span><span class="n">v4</span><span class="p">[</span><span class="mi">56</span><span class="p">]]</span> <span class="o">=</span> <span class="n">v28</span><span class="p">[</span><span class="n">v12</span> <span class="o">+</span> <span class="n">v27</span> <span class="o">*</span> <span class="n">v13</span><span class="p">];</span>
      <span class="n">v11</span><span class="p">[</span><span class="n">v4</span><span class="p">[</span><span class="mi">56</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">BYTE1</span><span class="p">(</span><span class="n">v28</span><span class="p">[</span><span class="n">v12</span> <span class="o">+</span> <span class="n">v27</span> <span class="o">*</span> <span class="n">v4</span><span class="p">[</span><span class="mi">58</span><span class="p">]]);</span>
      <span class="n">v11</span><span class="p">[</span><span class="n">v4</span><span class="p">[</span><span class="mi">56</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">BYTE2</span><span class="p">(</span><span class="n">v28</span><span class="p">[</span><span class="n">v12</span> <span class="o">+</span> <span class="n">v27</span> <span class="o">*</span> <span class="n">v4</span><span class="p">[</span><span class="mi">58</span><span class="p">]]);</span>
      <span class="n">v10</span> <span class="o">=</span> <span class="n">v27</span><span class="p">;</span>
      <span class="n">v11</span> <span class="o">+=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="o">++</span><span class="n">v12</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">while</span> <span class="p">(</span> <span class="n">v12</span> <span class="o">&lt;</span> <span class="n">v29</span> <span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">SHIDWORD</span><span class="p">(</span><span class="n">v30</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">v30</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">_DWORD</span><span class="p">)</span><span class="n">v30</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">MessageBoxA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Try Again!&quot;</span><span class="p">,</span> <span class="s">&quot;tip&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="n">v18</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="p">(</span><span class="kr">__stdcall</span> <span class="o">*</span><span class="p">)(</span><span class="kt">int</span> <span class="o">*</span><span class="p">,</span> <span class="kr">__int64</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span><span class="p">))</span><span class="n">v4</span><span class="p">[</span><span class="mi">56</span><span class="p">];</span>
  <span class="n">v19</span> <span class="o">=</span> <span class="n">v4</span><span class="p">[</span><span class="mi">57</span><span class="p">];</span>
  <span class="n">LODWORD</span><span class="p">(</span><span class="n">v30</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="n">v18</span><span class="p">(</span><span class="n">v4</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v30</span><span class="p">,</span> <span class="n">v19</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">_DWORD</span><span class="p">)</span><span class="n">v30</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">MessageBoxA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Try Again!&quot;</span><span class="p">,</span> <span class="s">&quot;tip&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="n">v20</span> <span class="o">=</span> <span class="n">v4</span><span class="p">[</span><span class="mi">50</span><span class="p">];</span>
  <span class="n">v21</span> <span class="o">=</span> <span class="n">GdipGetImagePixelFormat</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">v20</span> <span class="o">+</span> <span class="mi">4</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">v29</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v21</span> <span class="p">)</span>
    <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">v20</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">v21</span><span class="p">;</span>
  <span class="n">v22</span> <span class="o">=</span> <span class="n">v4</span><span class="p">[</span><span class="mi">50</span><span class="p">];</span>
  <span class="n">v23</span> <span class="o">=</span> <span class="n">GdipBitmapLockBits</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">v22</span> <span class="o">+</span> <span class="mi">4</span><span class="p">),</span> <span class="n">v4</span><span class="p">[</span><span class="mi">49</span><span class="p">],</span> <span class="mi">7</span><span class="p">,</span> <span class="n">v29</span><span class="p">,</span> <span class="n">v4</span><span class="p">[</span><span class="mi">51</span><span class="p">]);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v23</span> <span class="p">)</span>
    <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">v22</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">v23</span><span class="p">;</span>
  <span class="n">memcpy_0</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v9</span><span class="p">[</span><span class="n">HIDWORD</span><span class="p">(</span><span class="n">v30</span><span class="p">)</span> <span class="o">+</span> <span class="n">v30</span> <span class="o">*</span> <span class="n">v4</span><span class="p">[</span><span class="mi">58</span><span class="p">]],</span> <span class="n">v32</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">v31</span><span class="p">);</span>
  <span class="n">v24</span> <span class="o">=</span> <span class="n">v4</span><span class="p">[</span><span class="mi">50</span><span class="p">];</span>
  <span class="n">v25</span> <span class="o">=</span> <span class="n">GdipBitmapUnlockBits</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">v24</span> <span class="o">+</span> <span class="mi">4</span><span class="p">),</span> <span class="n">v4</span><span class="p">[</span><span class="mi">51</span><span class="p">]);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v25</span> <span class="p">)</span>
    <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">v24</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">v25</span><span class="p">;</span>
  <span class="n">sub_1062880</span><span class="p">();</span>
  <span class="n">MessageBoxA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;You get it!&quot;</span><span class="p">,</span> <span class="s">&quot;tip&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="n">sub_106C00A</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
  <span class="k">return</span> <span class="nf">sub_106C22D</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>这一句限制了输入必须为0 or 1:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span> <span class="k">if</span> <span class="p">(</span> <span class="n">v15</span> <span class="o">!=</span> <span class="sc">&#39;0&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">v15</span> <span class="o">!=</span> <span class="sc">&#39;1&#39;</span> <span class="p">)</span>
</pre></div>
</td></tr></table>

<p>调试运行过程中，可知v13 = 0x200：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">v13</span> <span class="o">=</span> <span class="n">v4</span><span class="p">[</span><span class="mi">58</span><span class="p">];</span>                               <span class="c1">// 0x200                           if ( v12 &gt;= v13 )                           // 0x200 * 0x200</span>
      <span class="k">break</span><span class="p">;</span>
</pre></div>
</td></tr></table>

<p>这一部分的逻辑很像之前做过的Bugku里面的<a href="https://alikas.cf/post/727878e0.html">Mountain climbing</a></p>
<p>因为静态找不到mountain，所以只能在动态调试过程中将mountain dump出来，脚本如下：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">ida_bytes</span>
<span class="n">addr</span> <span class="o">=</span> <span class="mh">0x03A24020</span>
<span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;data.txt&quot;</span><span class="p">,</span><span class="s2">&quot;wb+&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mh">0x200</span> <span class="o">*</span> <span class="mh">0x200</span><span class="p">):</span>
    <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">ida_bytes</span><span class="o">.</span><span class="n">get_dword</span><span class="p">(</span><span class="n">addr</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)))</span>
    <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p>得到：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>10256753
15502165
5303425
3
....
</pre></div>
</td></tr></table>

<p>动态规划求解：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">data</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;data.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="nb">input</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
<span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mh">0x200</span><span class="p">):</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mh">0x200</span><span class="p">):</span>
        <span class="n">num</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
    <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span>

<span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span>  <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
            <span class="nb">max</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
            <span class="nb">max</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">path</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">t</span>
        <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">max</span>

<span class="c1"># print(hex(data[0][0][0]))</span>
<span class="nb">input</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
<span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mh">0x200</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="nb">input</span> <span class="o">+=</span> <span class="n">path</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">path</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="k">print</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">input</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<p>求得512位输入：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>00000000010101000000000111100111111110100111100101001000101010010011101100111101011111111111111111001110111011011000000101110111001111100100011000000000000110001111110100000000001101110111010101011111000101110000011000111001110000000000000000000000011001000010000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000011100011111110000100111000000000000000000000000000000010000000000000001000001100000000000000101000000000100000010000000000000000010000000000000000000000
</pre></div>
</td></tr></table>

<h3 id="_2">第二部分</h3>
<p>接着分析这个函数：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>  <span class="n">v18</span><span class="p">(</span><span class="n">v4</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v30</span><span class="p">,</span> <span class="n">v19</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p>在动态调试过程中可以将汇编代码转成一个函数进行静态分析：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">int</span> <span class="kr">__stdcall</span> <span class="nf">sub_3B46020</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="n">a1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a3</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">signed</span> <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// [esp+D0h] [ebp-28Ch]</span>
  <span class="kt">signed</span> <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [esp+DCh] [ebp-280h]</span>
  <span class="kr">__int64</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// [esp+E8h] [ebp-274h]</span>
  <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// [esp+F0h] [ebp-26Ch]</span>
  <span class="kt">int</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// [esp+F4h] [ebp-268h]</span>
  <span class="kt">int</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// [esp+F8h] [ebp-264h]</span>
  <span class="kt">int</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// [esp+FCh] [ebp-260h]</span>
  <span class="kt">int</span> <span class="n">v11</span><span class="p">;</span> <span class="c1">// [esp+100h] [ebp-25Ch]</span>
  <span class="kt">int</span> <span class="n">v12</span><span class="p">;</span> <span class="c1">// [esp+104h] [ebp-258h]</span>
  <span class="kt">int</span> <span class="n">v13</span><span class="p">;</span> <span class="c1">// [esp+108h] [ebp-254h]</span>
  <span class="kt">int</span> <span class="n">v14</span><span class="p">;</span> <span class="c1">// [esp+10Ch] [ebp-250h]</span>
  <span class="kt">int</span> <span class="n">v15</span><span class="p">;</span> <span class="c1">// [esp+110h] [ebp-24Ch]</span>
  <span class="kt">int</span> <span class="n">v16</span><span class="p">;</span> <span class="c1">// [esp+114h] [ebp-248h]</span>
  <span class="kt">int</span> <span class="n">v17</span><span class="p">;</span> <span class="c1">// [esp+118h] [ebp-244h]</span>
  <span class="kt">int</span> <span class="n">v18</span><span class="p">;</span> <span class="c1">// [esp+11Ch] [ebp-240h]</span>
  <span class="kt">int</span> <span class="n">v19</span><span class="p">;</span> <span class="c1">// [esp+120h] [ebp-23Ch]</span>
  <span class="kt">int</span> <span class="n">v20</span><span class="p">;</span> <span class="c1">// [esp+124h] [ebp-238h]</span>
  <span class="kt">int</span> <span class="n">v21</span><span class="p">;</span> <span class="c1">// [esp+2F0h] [ebp-6Ch]</span>
  <span class="kt">int</span> <span class="n">v22</span><span class="p">;</span> <span class="c1">// [esp+2FCh] [ebp-60h]</span>
  <span class="kt">int</span> <span class="n">v23</span><span class="p">;</span> <span class="c1">// [esp+308h] [ebp-54h]</span>
  <span class="kt">int</span> <span class="n">v24</span><span class="p">;</span> <span class="c1">// [esp+314h] [ebp-48h]</span>
  <span class="kt">int</span> <span class="n">v25</span><span class="p">;</span> <span class="c1">// [esp+320h] [ebp-3Ch]</span>
  <span class="kt">int</span> <span class="n">v26</span><span class="p">;</span> <span class="c1">// [esp+32Ch] [ebp-30h]</span>
  <span class="kt">int</span> <span class="n">v27</span><span class="p">;</span> <span class="c1">// [esp+338h] [ebp-24h]</span>
  <span class="kt">int</span> <span class="n">v28</span><span class="p">;</span> <span class="c1">// [esp+344h] [ebp-18h]</span>
  <span class="kt">int</span> <span class="n">v29</span><span class="p">;</span> <span class="c1">// [esp+350h] [ebp-Ch]</span>

  <span class="n">v29</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">53</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a1</span><span class="p">[</span><span class="mi">58</span><span class="p">];</span>
  <span class="n">v28</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">55</span><span class="p">]</span> <span class="o">+</span> <span class="mi">12</span><span class="p">;</span>
  <span class="n">v27</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">a1</span><span class="p">[</span><span class="mi">55</span><span class="p">];</span>
  <span class="n">v26</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span><span class="p">[</span><span class="mi">55</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="p">);</span>
  <span class="n">v25</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span><span class="p">[</span><span class="mi">55</span><span class="p">]</span> <span class="o">+</span> <span class="mi">8</span><span class="p">);</span>
  <span class="n">v24</span> <span class="o">=</span> <span class="n">v28</span><span class="p">;</span>
  <span class="n">v23</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v22</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v21</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v6</span> <span class="o">=</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
  <span class="n">v7</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v8</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v9</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v10</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v11</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v12</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v13</span> <span class="o">=</span> <span class="n">v29</span><span class="p">;</span>
  <span class="n">v14</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v15</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v16</span> <span class="o">=</span> <span class="n">v27</span><span class="p">;</span>
  <span class="n">v17</span> <span class="o">=</span> <span class="n">v26</span><span class="p">;</span>
  <span class="n">v18</span> <span class="o">=</span> <span class="n">v25</span><span class="p">;</span>
  <span class="n">v19</span> <span class="o">=</span> <span class="n">v28</span><span class="p">;</span>
  <span class="n">v20</span> <span class="o">=</span> <span class="n">a2</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">v23</span> <span class="o">+</span> <span class="n">a3</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v23</span> <span class="o">+</span> <span class="n">a3</span><span class="p">)</span> <span class="p">)</span>
      <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
    <span class="n">v21</span> <span class="o">+=</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)(</span><span class="n">v23</span> <span class="o">+</span> <span class="n">a3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">48</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">v23</span> <span class="o">%</span> <span class="mi">6</span><span class="p">;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">v23</span> <span class="o">/</span> <span class="mi">6</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v23</span> <span class="o">%</span> <span class="mi">6</span> <span class="o">!=</span> <span class="mi">5</span> <span class="p">)</span>
      <span class="k">goto</span> <span class="n">LABEL_76</span><span class="p">;</span>
    <span class="k">switch</span> <span class="p">(</span> <span class="n">v21</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>
        <span class="n">v21</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">24</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
          <span class="n">v21</span> <span class="o">+=</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)(</span><span class="o">++</span><span class="n">v23</span> <span class="o">+</span> <span class="n">a3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">48</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">;</span>
        <span class="n">LODWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="n">v21</span><span class="p">;</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
        <span class="n">v21</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">24</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
          <span class="n">v21</span> <span class="o">+=</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)(</span><span class="o">++</span><span class="n">v23</span> <span class="o">+</span> <span class="n">a3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">48</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">j</span><span class="p">;</span>
        <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="n">v21</span><span class="p">;</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
        <span class="n">LODWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int16</span> <span class="o">*</span><span class="p">)(</span><span class="n">v29</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">v22</span><span class="o">++</span><span class="p">);</span>
<span class="nl">LABEL_75</span><span class="p">:</span>
        <span class="n">v21</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nl">LABEL_76</span><span class="p">:</span>
        <span class="o">++</span><span class="n">v23</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
        <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="n">v6</span><span class="p">;</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">4</span><span class="o">:</span>
        <span class="n">v8</span> <span class="o">=</span> <span class="n">v7</span><span class="p">;</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">5</span><span class="o">:</span>
        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">signed</span> <span class="kt">int</span><span class="p">)</span><span class="n">v6</span> <span class="o">&lt;</span> <span class="mi">128</span> <span class="p">)</span>
          <span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v6</span> <span class="o">+</span> <span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">);</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">6</span><span class="o">:</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">SHIDWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">128</span> <span class="p">)</span>
          <span class="n">LODWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v6</span> <span class="o">+</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">));</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">7</span><span class="o">:</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">v7</span> <span class="o">&lt;</span> <span class="mi">128</span> <span class="p">)</span>
          <span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v6</span> <span class="o">+</span> <span class="n">v7</span><span class="p">)</span> <span class="o">=</span> <span class="n">v8</span><span class="p">;</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">8</span><span class="o">:</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">v8</span> <span class="o">&lt;</span> <span class="mi">128</span> <span class="p">)</span>
          <span class="n">v7</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v6</span> <span class="o">+</span> <span class="n">v8</span><span class="p">);</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">9</span><span class="o">:</span>
        <span class="n">LODWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">v6</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">));</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">10</span><span class="o">:</span>
        <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">v6</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">))</span> <span class="o">=</span> <span class="n">v9</span><span class="p">;</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">11</span><span class="o">:</span>
        <span class="n">LODWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">+</span> <span class="n">v6</span><span class="p">;</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">12</span><span class="o">:</span>
        <span class="n">LODWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="n">v6</span> <span class="o">-</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">);</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">13</span><span class="o">:</span>
        <span class="n">LODWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">*</span> <span class="n">v6</span><span class="p">;</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">14</span><span class="o">:</span>
        <span class="n">LODWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="kt">signed</span> <span class="kt">int</span><span class="p">)</span><span class="n">v6</span> <span class="o">/</span> <span class="n">SHIDWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">);</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">15</span><span class="o">:</span>
        <span class="n">LODWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">v6</span><span class="p">;</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">16</span><span class="o">:</span>
        <span class="n">LODWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">|</span> <span class="n">v6</span><span class="p">;</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">17</span><span class="o">:</span>
        <span class="n">LODWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">^</span> <span class="n">v6</span><span class="p">;</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">18</span><span class="o">:</span>
        <span class="n">LODWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">_DWORD</span><span class="p">)</span><span class="n">v6</span> <span class="o">&lt;&lt;</span> <span class="n">SBYTE4</span><span class="p">(</span><span class="n">v6</span><span class="p">);</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">19</span><span class="o">:</span>
        <span class="n">LODWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="kt">signed</span> <span class="kt">int</span><span class="p">)</span><span class="n">v6</span> <span class="o">&gt;&gt;</span> <span class="n">SBYTE4</span><span class="p">(</span><span class="n">v6</span><span class="p">);</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">20</span><span class="o">:</span>
        <span class="n">LODWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="kt">signed</span> <span class="kt">int</span><span class="p">)</span><span class="n">v6</span> <span class="o">&gt;</span> <span class="n">SHIDWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">);</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">21</span><span class="o">:</span>
        <span class="n">LODWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="kt">signed</span> <span class="kt">int</span><span class="p">)</span><span class="n">v6</span> <span class="o">&lt;</span> <span class="n">SHIDWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">);</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">22</span><span class="o">:</span>
        <span class="n">LODWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="n">v6</span> <span class="o">==</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">);</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">23</span><span class="o">:</span>
        <span class="n">LODWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="n">v6</span> <span class="o">!=</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">);</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">24</span><span class="o">:</span>
        <span class="n">LODWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="n">v23</span><span class="p">;</span>
        <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">25</span><span class="o">:</span>
        <span class="n">v23</span> <span class="o">=</span> <span class="n">v6</span><span class="p">;</span>
        <span class="n">v21</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">26</span><span class="o">:</span>
        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">_DWORD</span><span class="p">)</span><span class="n">v6</span> <span class="p">)</span>
          <span class="k">goto</span> <span class="n">LABEL_75</span><span class="p">;</span>
        <span class="n">v23</span> <span class="o">=</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v6</span><span class="p">);</span>
        <span class="n">v21</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">default</span><span class="o">:</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>大概是个VM，调试过程中将操作码dump出来，嗯，复制粘贴</p>
<p><img alt="" src="https://raw.githubusercontent.com/Alikas0/files/master/img/20190725195653.png" /></p>
<p>之后分析VM过程，写个脚本将过程大致还原一下：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;000000010101100100000000000000110000010000010110100000000011000000000000000000001100110000000000110000000000000000000000101000000000000000000000000000000000110000000000010000000000000000000000101000000000111000000000000000000000110000011000110000111000010010110000000000110000000000000000000000101000000000100000000000000000000000110000000000010000000000000000000000101000000000011000000000000000000000110000011000111000110100110000000000011000000000000000000000101000100000111000000000000000000000011000100000100000000000000000000000110100110000000000111000000000000000000000101000000000000000000000000000000000100110100000011000000000000000000000011000100000111000000000000000000000101100100000111111000100001011110000011010100000011011000011000000000000010110100000011000000000000000000000011000110000000000110000000000000000000000101000000000100000000000000000000000110000000000010000000000000000000000101000100000110100000000000000000000011000111000100010110000000000110100000000000000000000101000100000001100000000000000000000011000111000100010110000000000001100000000000000000000101000100000101100000000000000000000011000111000100010110000000000101100000000000000000000101000000000111000000000000000000000100000000000000000000000000000101000100000101100000000000000000000011000110000000000110000000000000000000000101000000000100000000000000000000000110000000000010000000000000000000000101000100000111000000000000000000000011000111000101010100000011011111001000000000000010110100000011000000000000000000000011000110000000000110000000000000000000000101000000000100000000000000000000000110000000000010000000000000000000000101000100000111000000000000000000000011000111000110100110000000000000010000000000000000000101000100000111000000000000000000000011000110000000000110000000000000000000000101000000000100000000000000000000000110000000000010000000000000000000000101000100000011100000000000000000000011000111000100100110000000000100010000000000000000000101000100000000010000000000000000000011000110000000000110000000000000000000000101000000000100000000000000000000000110000000000010000000000000000000000101000100000100010000000000000000000011000111000100010110000000000001000000000000000000000101000100000111000000000000000000000011000110000000000110000000000000000000000101000000000100000000000000000000000110000000000010000000000000000000000101000100000011100000000000000000000011000111000010100100000111000000000000000000000011000100000100000000000000000000000110100110000000000111000000000000000000000101000000000000001110010000000000000100110100000110100000000000000000000011000110000000000001000000000000000000000101000100000111100000000000000000000011000100000000000000000000000000000010100100000001100000000000000000000011000110000000000001000000000000000000000101000100000111100000000000000000000011000100000100000000000000000000000010100100000101100000000000000000000011000110000000000001000000000000000000000101000100000111100000000000000000000011000100000010000000000000000000000010100100000011100000000000000000000011000110000000000001000000000000000000000101000100000111100000000000000000000011000100000110000000000000000000000010100&#39;</span>


<span class="n">opcode</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1">#LODWORD(x) = r0</span>
<span class="c1">#HIDWORD(x) = r1</span>
<span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">code</span><span class="p">):</span>
    <span class="n">opcode</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;0b&#39;</span><span class="o">+</span> <span class="n">code</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">6</span>
    <span class="k">if</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">num</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;0b&#39;</span><span class="o">+</span> <span class="n">code</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">24</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;mov r0,0x</span><span class="si">%x</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">num</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">24</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">num</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;0b&#39;</span><span class="o">+</span> <span class="n">code</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">24</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;mov r1,0x</span><span class="si">%x</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">num</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">24</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;mov r0，input[</span><span class="si">%d</span><span class="s1">]&#39;</span><span class="o">%</span> <span class="n">j</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;mov r1,r0&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;mov r3,r2&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;if r0 &lt; 128:&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">mov x[r0],r1&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;if r1 &lt; 128:&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">mov r0,x[r1]&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;if r3 &lt; 128:&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">mov x[r2],r3&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;if r2 &lt; 128:&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">mov r2,x[r3]&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;mov r0,x[4 * r1]&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0xA</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;mov x[4 * r1],r4&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0xB</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;add r0,r1&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0xC</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;sub r0,r1&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0xD</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;mul r0,r1&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0xE</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;div r0,r1&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0xF</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;and r0,r1&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0x10</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;or r0,r1&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0x11</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;xor r0,r1&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0x12</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;shl r0,r1&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0x13</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;shr r0,r1&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0x14</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;cmp r0,r1&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;setnle r0&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0x15</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;cmp r0,r1&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;setl r0&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0x16</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;cmp r0,r1&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;setz r0&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0x17</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;cmp r0,r1&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;setnz r0&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0x18</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;mov r0,rip&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0x19</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;mov rip,r0&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">opcode</span> <span class="o">==</span> <span class="mh">0x1A</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;cmp r0,0&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;je r1&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&lt;unknown&gt;&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>得到：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nv">mov</span> <span class="nv">r0</span>,<span class="mi">0</span><span class="nv">x26a</span>
<span class="nv">mov</span> <span class="nv">r1</span>,<span class="nv">r0</span>
<span class="nv">mov</span> <span class="nv">r0</span>，<span class="nv">input</span>[<span class="mi">0</span>]
<span class="nv">cmp</span> <span class="nv">r0</span>,<span class="mi">0</span>
<span class="nv">je</span> <span class="nv">r1</span>
<span class="nv">mov</span> <span class="nv">r1</span>,<span class="mi">0</span><span class="nv">x30</span>
<span class="nv">sub</span> <span class="nv">r0</span>,<span class="nv">r1</span>
<span class="nv">mov</span> <span class="nv">r1</span>,<span class="nv">r0</span>
<span class="nv">mov</span> <span class="nv">r0</span>,<span class="mi">0</span><span class="nv">x3</span>
<span class="k">if</span> <span class="nv">r0</span> <span class="o">&lt;</span> <span class="mi">128</span>:
    <span class="nv">mov</span> <span class="nv">x</span>[<span class="nv">r0</span>],<span class="nv">r1</span>
<span class="nv">mov</span> <span class="nv">r0</span>,<span class="mi">0</span><span class="nv">x0</span>
<span class="nv">mov</span> <span class="nv">r1</span>,<span class="nv">r0</span>
<span class="nv">mov</span> <span class="nv">r0</span>,<span class="mi">0</span><span class="nv">x2</span>
<span class="k">if</span> <span class="nv">r0</span> <span class="o">&lt;</span> <span class="mi">128</span>:
    <span class="nv">mov</span> <span class="nv">x</span>[<span class="nv">r0</span>],<span class="nv">r1</span>
<span class="nv">mov</span> <span class="nv">r0</span>,<span class="mi">0</span><span class="nv">x7</span>
<span class="nv">mov</span> <span class="nv">r1</span>,<span class="nv">r0</span>
<span class="k">if</span> <span class="nv">r1</span> <span class="o">&lt;</span> <span class="mi">128</span>:
    <span class="nv">mov</span> <span class="nv">r0</span>,<span class="nv">x</span>[<span class="nv">r1</span>]
<span class="nv">mov</span> <span class="nv">r1</span>,<span class="nv">r0</span>
<span class="k">if</span> <span class="nv">r3</span> <span class="o">&lt;</span> <span class="mi">128</span>:
    <span class="nv">mov</span> <span class="nv">x</span>[<span class="nv">r2</span>],<span class="nv">r3</span>
<span class="nv">shl</span> <span class="nv">r0</span>,<span class="nv">r1</span>
<span class="nv">mov</span> <span class="nv">r1</span>,<span class="nv">r0</span>
<span class="nv">mov</span> <span class="nv">r0</span>,<span class="mi">0</span><span class="nv">x3</span>
<span class="k">if</span> <span class="nv">r0</span> <span class="o">&lt;</span> <span class="mi">128</span>:
    <span class="nv">mov</span> <span class="nv">x</span>[<span class="nv">r0</span>],<span class="nv">r1</span>
<span class="nv">mov</span> <span class="nv">r0</span>,<span class="mi">0</span><span class="nv">x1</span>
<span class="nv">mov</span> <span class="nv">r1</span>,<span class="nv">r0</span>
<span class="nv">mov</span> <span class="nv">r0</span>,<span class="mi">0</span><span class="nv">x2</span>
<span class="k">if</span> <span class="nv">r0</span> <span class="o">&lt;</span> <span class="mi">128</span>:
    <span class="nv">mov</span> <span class="nv">x</span>[<span class="nv">r0</span>],<span class="nv">r1</span>
<span class="nv">mov</span> <span class="nv">r0</span>,<span class="mi">0</span><span class="nv">x6</span>
<span class="nv">mov</span> <span class="nv">r1</span>,<span class="nv">r0</span>
<span class="k">if</span> <span class="nv">r1</span> <span class="o">&lt;</span> <span class="mi">128</span>:
    <span class="nv">mov</span> <span class="nv">r0</span>,<span class="nv">x</span>[<span class="nv">r1</span>]
<span class="k">if</span> <span class="nv">r3</span> <span class="o">&lt;</span> <span class="mi">128</span>:
    <span class="nv">mov</span> <span class="nv">x</span>[<span class="nv">r2</span>],<span class="nv">r3</span>
<span class="nv">add</span> <span class="nv">r0</span>,<span class="nv">r1</span>
<span class="nv">mov</span> <span class="nv">r1</span>,<span class="nv">r0</span>
<span class="nv">mov</span> <span class="nv">r0</span>,<span class="mi">0</span><span class="nv">x6</span>
<span class="k">if</span> <span class="nv">r0</span> <span class="o">&lt;</span> <span class="mi">128</span>:
    <span class="nv">mov</span> <span class="nv">x</span>[<span class="nv">r0</span>],<span class="nv">r1</span>
<span class="nv">mov</span> <span class="nv">r1</span>,<span class="mi">0</span><span class="nv">x7</span>
<span class="k">if</span> <span class="nv">r1</span> <span class="o">&lt;</span> <span class="mi">128</span>:
    <span class="nv">mov</span> <span class="nv">r0</span>,<span class="nv">x</span>[<span class="nv">r1</span>]
<span class="nv">mov</span> <span class="nv">r1</span>,<span class="mi">0</span><span class="nv">x1</span>
<span class="nv">add</span> <span class="nv">r0</span>,<span class="nv">r1</span>
<span class="nv">mov</span> <span class="nv">r1</span>,<span class="nv">r0</span>
<span class="nv">mov</span> <span class="nv">r0</span>,<span class="mi">0</span><span class="nv">x7</span>
<span class="k">if</span> <span class="nv">r0</span> <span class="o">&lt;</span> <span class="mi">128</span>:
    <span class="nv">mov</span> <span class="nv">x</span>[<span class="nv">r0</span>],<span class="nv">r1</span>
<span class="nv">mov</span> <span class="nv">r0</span>,<span class="mi">0</span><span class="nv">x0</span>
<span class="nv">mov</span> <span class="nv">rip</span>,<span class="nv">r0</span>
<span class="nv">mov</span> <span class="nv">r1</span>,<span class="mi">0</span><span class="nv">x6</span>
<span class="k">if</span> <span class="nv">r1</span> <span class="o">&lt;</span> <span class="mi">128</span>:
    <span class="nv">mov</span> <span class="nv">r0</span>,<span class="nv">x</span>[<span class="nv">r1</span>]
<span class="nv">mov</span> <span class="nv">r1</span>,<span class="mi">0</span><span class="nv">x7</span>
<span class="nv">mul</span> <span class="nv">r0</span>,<span class="nv">r1</span>
<span class="nv">mov</span> <span class="nv">r1</span>,<span class="mi">0</span><span class="nv">xf423f</span>
<span class="nv">cmp</span> <span class="nv">r0</span>,<span class="nv">r1</span>
<span class="nv">setz</span> <span class="nv">r0</span>
<span class="nv">mov</span> <span class="nv">r1</span>,<span class="mi">0</span><span class="nv">xc36</span>
<span class="nv">cmp</span> <span class="nv">r0</span>,<span class="mi">0</span>
<span class="nv">je</span> <span class="nv">r1</span>
.....
</pre></div>
</td></tr></table>

<p>接下来就只能靠猜的了0.0</p>
<p>由于又这几句：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">mov</span> <span class="n">r1</span><span class="p">,</span><span class="mi">0</span><span class="n">x7</span>
<span class="n">mul</span> <span class="n">r0</span><span class="p">,</span><span class="n">r1</span>
<span class="n">mov</span> <span class="n">r1</span><span class="p">,</span><span class="mi">0</span><span class="n">xf423f</span>
<span class="n">cmp</span> <span class="n">r0</span><span class="p">,</span><span class="n">r1</span>
<span class="n">setz</span> <span class="n">r0</span>
<span class="n">mov</span> <span class="n">r1</span><span class="p">,</span><span class="mi">0</span><span class="n">xc36</span>
<span class="n">cmp</span> <span class="n">r0</span><span class="p">,</span><span class="mi">0</span>
<span class="n">je</span> <span class="n">r1</span>
</pre></div>
</td></tr></table>

<p>猜测这里是check，也就是说有另外一个数(暂时不知道这个数怎么算出来的)，这个数*7 == 0xf423f, 也就是0x22e09。又因为整一个逻辑下来只有一句<code>shl r0,r1</code>，所以猜测有另外一个二进制数跟在前512的输入之后，而这个二进制数应该为‭100010111000001001‬(==0x22e09)而且输入应该是大端序，也就是100100000111010001,即整个第二部分逻辑大概是</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nb">input</span> <span class="o">=</span> <span class="s2">&quot;100100000111010001&quot;</span>
<span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">input</span><span class="p">)):</span>
    <span class="nb">sum</span> <span class="o">+=</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span> <span class="o">-</span> <span class="mh">0x30</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">i</span>
<span class="k">if</span> <span class="nb">sum</span><span class="o">*</span><span class="mi">7</span> <span class="o">==</span> <span class="mh">0xf423f</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;sucess&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>所以整个输入为前512位输出接上100100000111010001：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>00000000010101000000000111100111111110100111100101001000101010010011101100111101011111111111111111001110111011011000000101110111001111100100011000000000000110001111110100000000001101110111010101011111000101110000011000111001110000000000000000000000011001000010000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000011100011111110000100111000000000000000000000000000000010000000000000001000001100000000000000101000000000100000010000000000000000010000000000000000000000100100000111010001
</pre></div>
</td></tr></table>

<p>得到flag:13yR01sw3iy1l1n9</p>
<p><img alt="" src="https://raw.githubusercontent.com/Alikas0/files/master/img/20190725202207.png" /></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../2019aurora/" title="2019 Aurora内部赛" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  上一页
                </span>
                2019 Aurora内部赛
              </span>
            </div>
          </a>
        
        
          <a href="../2019starctf/" title="2019 *CTF" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  下一页
                </span>
                2019 *CTF
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/Alikas0" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://t.me/Alikas" class="md-footer-social__link fa fa-telegram"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.245445c6.js"></script>
      
        
        
          
          <script src="../../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../../../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../../../assets/javascripts/lunr/lunr.ja.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
        <script src="../../../js/extra.js"></script>
      
    
  </body>
</html>