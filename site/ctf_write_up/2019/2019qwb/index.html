



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://blog.alikas.cf/ctf_write_up/2019/2019qwb/">
      
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="ja">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="https://raw.githubusercontent.com/Alikas0/files/master/videos/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>2019 强网杯 - Alikas|station</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.0284f74d.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.01803549.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#justre" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://blog.alikas.cf" title="Alikas|station" class="md-header-nav__button md-logo">
          
            <i class="md-icon">border_color</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Alikas|station
            </span>
            <span class="md-header-nav__topic">
              
                2019 强网杯
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/Alikas0/Alikas0.github.io/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Alikas0.github.io
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://blog.alikas.cf" title="Alikas|station" class="md-nav__button md-logo">
      
        <i class="md-icon">border_color</i>
      
    </a>
    Alikas|station
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/Alikas0/Alikas0.github.io/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Alikas0.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Homepage
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Homepage
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../.." title="主页" class="md-nav__link">
      主页
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../links/" title="友情链接" class="md-nav__link">
      友情链接
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      CTF Write-Up
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        CTF Write-Up
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1">
    
    <label class="md-nav__link" for="nav-2-1">
      2018
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        2018
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../2018/2018rctf/" title="2018 RCTF" class="md-nav__link">
      2018 RCTF
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2" checked>
    
    <label class="md-nav__link" for="nav-2-2">
      2019
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        2019
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../2019aurora/" title="2019 Aurora内部赛" class="md-nav__link">
      2019 Aurora内部赛
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../2019rctf/" title="2019 RCTF国际赛" class="md-nav__link">
      2019 RCTF国际赛
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../2019starctf/" title="2019 *CTF" class="md-nav__link">
      2019 *CTF
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        2019 强网杯
      </label>
    
    <a href="./" title="2019 强网杯" class="md-nav__link md-nav__link--active">
      2019 强网杯
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#justre" title="JustRe" class="md-nav__link">
    JustRe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_ad" title="强网先锋_AD" class="md-nav__link">
    强网先锋_AD
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#webassembly" title="webassembly" class="md-nav__link">
    webassembly
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      Exams
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        Exams
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3-1" type="checkbox" id="nav-2-3-1">
    
    <label class="md-nav__link" for="nav-2-3-1">
      BUUCTF
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-3-1">
        BUUCTF
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/buuctf/introduction/" title="简介" class="md-nav__link">
      简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/buuctf/misc/" title="MISC" class="md-nav__link">
      MISC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/buuctf/reverse/" title="Reverse" class="md-nav__link">
      Reverse
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3-2" type="checkbox" id="nav-2-3-2">
    
    <label class="md-nav__link" for="nav-2-3-2">
      旧版Bugku
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-3-2">
        旧版Bugku
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/old_bugku/introduction/" title="简介" class="md-nav__link">
      简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/old_bugku/reverse/" title="Reverse" class="md-nav__link">
      Reverse
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3-3" type="checkbox" id="nav-2-3-3">
    
    <label class="md-nav__link" for="nav-2-3-3">
      实验吧
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-3-3">
        实验吧
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/shiyanba/introduction/" title="简介" class="md-nav__link">
      简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/shiyanba/reverse/" title="Reverse" class="md-nav__link">
      Reverse
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      CTF Tools
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        CTF Tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_tools/xortool/" title="Xortool" class="md-nav__link">
      Xortool
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_tools/ida_python/" title="IDA python" class="md-nav__link">
      IDA python
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      MISC
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        MISC
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/python_script/" title="python脚本" class="md-nav__link">
      python脚本
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/big_little_ending/" title="大端序和小端序" class="md-nav__link">
      大端序和小端序
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      提问的智慧
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        提问的智慧
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/introduction/" title="简介" class="md-nav__link">
      简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/before_you_ask/" title="在提问之前" class="md-nav__link">
      在提问之前
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/when_you_ask/" title="当你在提问时" class="md-nav__link">
      当你在提问时
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/how_to_interpret_answers/" title="如何解读答案" class="md-nav__link">
      如何解读答案
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/on_not_reacting_like_loser/" title="如何避免扮演失败者" class="md-nav__link">
      如何避免扮演失败者
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/questions_not_to_ask/" title="不该问的问题" class="md-nav__link">
      不该问的问题
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/good_and_bad_questions/" title="好问题与蠢问题" class="md-nav__link">
      好问题与蠢问题
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/if_you_cant_get_an_answer/" title="如果得不到回答" class="md-nav__link">
      如果得不到回答
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/how_to_answer_questions_in_a_helpful_way/" title="如何更好地回答问题" class="md-nav__link">
      如何更好地回答问题
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/how_to_ask_questions_the_smart_way/" title="完整版" class="md-nav__link">
      完整版
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      Install WSL
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        Install WSL
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/wsl/install/" title="安装" class="md-nav__link">
      安装
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/wsl/mklink/" title="mklink软链接到非系统盘" class="md-nav__link">
      mklink软链接到非系统盘
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/wsl/optimization/" title="子系统优化" class="md-nav__link">
      子系统优化
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/wsl/questions/" title="杂七杂八问题" class="md-nav__link">
      杂七杂八问题
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/wsl/reference/" title="参考资料" class="md-nav__link">
      参考资料
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#justre" title="JustRe" class="md-nav__link">
    JustRe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_ad" title="强网先锋_AD" class="md-nav__link">
    强网先锋_AD
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#webassembly" title="webassembly" class="md-nav__link">
    webassembly
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/Alikas0/Alikas0.github.io/edit/master/docs/ctf_write_up/2019/2019qwb.md" title="编辑此页" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>2019 强网杯</h1>
                
                <p>2019强网杯线上赛RE-部分write up</p>
<p>这算是第一次参加正式比赛并且做出题目，记录一下！</p>
<p>虽然只是做出了两道很简单的题目0.0.....</p>
<p>比赛后在Apeng大佬的帮助下做出了wasm。</p>
<p>我真的是，太菜了........膜拜Apeng大佬！人又帅又会打CTF！</p>
<ul>
<li>2019.6.15更新，上传三道题的原题</li>
</ul>
<h2 id="justre">JustRe</h2>
<p>题目：<a href="https://raw.githubusercontent.com/Alikas0/CTF/master/challenges/2019/QWB/JustRe/JustRe.rar">JustRe</a></p>
<p>打开来是这个样子，拖进IDA通过字符，定位到主函数</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">int</span> <span class="nf">sub_401BD0</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">char</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// [esp+4h] [ebp-68h]</span>

  <span class="n">puts</span><span class="p">(</span><span class="s">&quot;      #                        ######         &quot;</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">&quot;      # #    #  ####  #####    #     # ###### &quot;</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">&quot;      # #    # #        #      #     # #      &quot;</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">&quot;      # #    #  ####    #      ######  #####  &quot;</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">&quot;#     # #    #      #   #      #   #   #      &quot;</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">&quot;#     # #    # #    #   #      #    #  #      &quot;</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">&quot; #####   ####   ####    #      #     # ###### &quot;</span><span class="p">);</span>
  <span class="n">sub_401CE0</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v1</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">sub_401610</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v1</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">sub_4018A0</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v1</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">&quot;sorry..&quot;</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>重点在函数sub_401610()中</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">signed</span> <span class="kt">int</span> <span class="n">__usercall</span> <span class="n">sub_401610</span><span class="err">@</span><span class="o">&lt;</span><span class="n">eax</span><span class="o">&gt;</span><span class="p">(</span><span class="kt">int</span> <span class="n">a1</span><span class="err">@</span><span class="o">&lt;</span><span class="n">ecx</span><span class="o">&gt;</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a2</span><span class="err">@</span><span class="o">&lt;</span><span class="n">ebp</span><span class="o">&gt;</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// edi</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// esi</span>
  <span class="kt">char</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// dh</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// dl</span>
  <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">signed</span> <span class="kt">int</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// ecx</span>
  <span class="kr">__m128i</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// xmm5</span>
  <span class="kt">char</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// dl</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v11</span><span class="p">;</span> <span class="c1">// dh</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v12</span><span class="p">;</span> <span class="c1">// cl</span>
  <span class="kt">char</span> <span class="n">v13</span><span class="p">;</span> <span class="c1">// ch</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v14</span><span class="p">;</span> <span class="c1">// ch</span>
  <span class="kt">char</span> <span class="n">v15</span><span class="p">;</span> <span class="c1">// dl</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v16</span><span class="p">;</span> <span class="c1">// dh</span>
  <span class="kt">signed</span> <span class="kt">int</span> <span class="n">v17</span><span class="p">;</span> <span class="c1">// esi</span>
  <span class="kr">__m128i</span> <span class="n">v18</span><span class="p">;</span> <span class="c1">// xmm0</span>
  <span class="kr">__m128i</span> <span class="n">v19</span><span class="p">;</span> <span class="c1">// xmm0</span>
  <span class="kt">signed</span> <span class="kt">int</span> <span class="n">v20</span><span class="p">;</span> <span class="c1">// esi</span>
  <span class="kr">__m128i</span> <span class="n">v21</span><span class="p">;</span> <span class="c1">// xmm4</span>
  <span class="kt">int</span> <span class="n">v22</span><span class="p">;</span> <span class="c1">// ecx</span>
  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v23</span><span class="p">;</span> <span class="c1">// rax</span>
  <span class="n">HANDLE</span> <span class="n">v24</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v26</span><span class="p">;</span> <span class="c1">// [esp-54h] [ebp-60h]</span>
  <span class="kr">__m128i</span> <span class="n">v27</span><span class="p">;</span> <span class="c1">// [esp-20h] [ebp-2Ch]</span>
  <span class="kt">int</span> <span class="n">v28</span><span class="p">;</span> <span class="c1">// [esp-8h] [ebp-14h]</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v29</span><span class="p">;</span> <span class="c1">// [esp-2h] [ebp-Eh]</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v30</span><span class="p">;</span> <span class="c1">// [esp-1h] [ebp-Dh]</span>
  <span class="kt">int</span> <span class="n">v31</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-Ch]</span>
  <span class="kt">int</span> <span class="n">v32</span><span class="p">;</span> <span class="c1">// [esp+4h] [ebp-8h]</span>
  <span class="kt">int</span> <span class="n">retaddr</span><span class="p">;</span> <span class="c1">// [esp+Ch] [ebp+0h]</span>

  <span class="n">v31</span> <span class="o">=</span> <span class="n">a2</span><span class="p">;</span>
  <span class="n">v32</span> <span class="o">=</span> <span class="n">retaddr</span><span class="p">;</span>
  <span class="n">v2</span> <span class="o">=</span> <span class="n">a1</span><span class="p">;</span>
  <span class="n">v26</span> <span class="o">=</span> <span class="n">__rdtsc</span><span class="p">();</span>
  <span class="n">v3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v4</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v5</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v4</span> <span class="o">+</span> <span class="n">a1</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v5</span> <span class="o">&gt;=</span> <span class="mi">48</span> <span class="o">&amp;&amp;</span> <span class="n">v5</span> <span class="o">&lt;=</span> <span class="mi">57</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">v6</span> <span class="o">=</span> <span class="n">v5</span> <span class="o">-</span> <span class="mi">65</span><span class="p">;</span>
      <span class="k">goto</span> <span class="n">LABEL_6</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">v6</span> <span class="o">=</span> <span class="n">v5</span> <span class="o">-</span> <span class="mi">65</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)(</span><span class="n">v5</span> <span class="o">-</span> <span class="mi">65</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mh">0x19u</span> <span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>
<span class="nl">LABEL_6</span><span class="p">:</span>
    <span class="n">v3</span> <span class="o">*=</span> <span class="mi">16</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)(</span><span class="n">v5</span> <span class="o">-</span> <span class="mi">48</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">9u</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">v7</span> <span class="o">=</span> <span class="n">v3</span> <span class="o">-</span> <span class="mi">48</span><span class="p">;</span>
<span class="nl">LABEL_10</span><span class="p">:</span>
      <span class="n">v3</span> <span class="o">=</span> <span class="n">v5</span> <span class="o">+</span> <span class="n">v7</span><span class="p">;</span>
      <span class="k">goto</span> <span class="n">LABEL_11</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v6</span> <span class="o">&lt;=</span> <span class="mh">0x19u</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">v7</span> <span class="o">=</span> <span class="n">v3</span> <span class="o">-</span> <span class="mi">55</span><span class="p">;</span>
      <span class="k">goto</span> <span class="n">LABEL_10</span><span class="p">;</span>
    <span class="p">}</span>
<span class="nl">LABEL_11</span><span class="p">:</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">++</span><span class="n">v4</span> <span class="o">&gt;=</span> <span class="mi">8</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">v8</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="k">goto</span> <span class="n">LABEL_14</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">v8</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nl">LABEL_14</span><span class="p">:</span>
  <span class="n">v9</span> <span class="o">=</span> <span class="n">_mm_shuffle_epi32</span><span class="p">(</span><span class="n">_mm_cvtsi32_si128</span><span class="p">(</span><span class="n">v3</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v8</span> <span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v10</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v2</span> <span class="o">+</span> <span class="mi">8</span><span class="p">);</span>
  <span class="n">v11</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v10</span> <span class="o">&gt;=</span> <span class="mi">48</span> <span class="o">&amp;&amp;</span> <span class="n">v10</span> <span class="o">&lt;=</span> <span class="mi">57</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v12</span> <span class="o">=</span> <span class="n">v10</span> <span class="o">-</span> <span class="mi">65</span><span class="p">;</span>
    <span class="n">v30</span> <span class="o">=</span> <span class="n">v10</span> <span class="o">-</span> <span class="mi">65</span><span class="p">;</span>
    <span class="k">goto</span> <span class="n">LABEL_19</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">v12</span> <span class="o">=</span> <span class="n">v10</span> <span class="o">-</span> <span class="mi">65</span><span class="p">;</span>
  <span class="n">v30</span> <span class="o">=</span> <span class="n">v10</span> <span class="o">-</span> <span class="mi">65</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)(</span><span class="n">v10</span> <span class="o">-</span> <span class="mi">65</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mh">0x19u</span> <span class="p">)</span>
  <span class="p">{</span>
<span class="nl">LABEL_34</span><span class="p">:</span>
    <span class="n">v17</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">goto</span> <span class="n">LABEL_35</span><span class="p">;</span>
  <span class="p">}</span>
<span class="nl">LABEL_19</span><span class="p">:</span>
  <span class="n">v13</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v2</span> <span class="o">+</span> <span class="mi">9</span><span class="p">);</span>
  <span class="n">v29</span> <span class="o">=</span> <span class="n">v12</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v13</span> <span class="o">&lt;</span> <span class="mi">48</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v12</span> <span class="o">=</span> <span class="n">v29</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">v13</span> <span class="o">&lt;=</span> <span class="mi">57</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v14</span> <span class="o">=</span> <span class="n">v13</span> <span class="o">-</span> <span class="mi">65</span><span class="p">;</span>
    <span class="k">goto</span> <span class="n">LABEL_24</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">v14</span> <span class="o">=</span> <span class="n">v13</span> <span class="o">-</span> <span class="mi">65</span><span class="p">;</span>
  <span class="n">v30</span> <span class="o">=</span> <span class="n">v12</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v14</span> <span class="o">&gt;</span> <span class="mh">0x19u</span> <span class="p">)</span>
    <span class="k">goto</span> <span class="n">LABEL_34</span><span class="p">;</span>
<span class="nl">LABEL_24</span><span class="p">:</span>
  <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)(</span><span class="n">v10</span> <span class="o">-</span> <span class="mi">48</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">9u</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v30</span> <span class="o">&gt;</span> <span class="mh">0x19u</span> <span class="p">)</span>
      <span class="n">v15</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">else</span>
      <span class="n">v15</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">*</span> <span class="p">(</span><span class="n">v10</span> <span class="o">-</span> <span class="mi">7</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">v15</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">*</span> <span class="n">v10</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">v16</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v2</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span> <span class="o">-</span> <span class="mi">48</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v16</span> <span class="o">&lt;=</span> <span class="mi">9u</span> <span class="p">)</span>
    <span class="k">goto</span> <span class="n">LABEL_33</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v14</span> <span class="o">&gt;</span> <span class="mh">0x19u</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v16</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nl">LABEL_33</span><span class="p">:</span>
    <span class="n">v11</span> <span class="o">=</span> <span class="n">v15</span> <span class="o">+</span> <span class="n">v16</span><span class="p">;</span>
    <span class="n">v17</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">goto</span> <span class="n">LABEL_35</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">v17</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">v11</span> <span class="o">=</span> <span class="n">v15</span> <span class="o">+</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v2</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span> <span class="o">-</span> <span class="mi">55</span><span class="p">;</span>
<span class="nl">LABEL_35</span><span class="p">:</span>
  <span class="n">v18</span> <span class="o">=</span> <span class="n">_mm_cvtsi32_si128</span><span class="p">((</span><span class="kt">char</span><span class="p">)</span><span class="n">v11</span><span class="p">);</span>
  <span class="n">v19</span> <span class="o">=</span> <span class="n">_mm_unpacklo_epi8</span><span class="p">(</span><span class="n">v18</span><span class="p">,</span> <span class="n">v18</span><span class="p">);</span>
  <span class="n">v27</span> <span class="o">=</span> <span class="n">_mm_shuffle_epi32</span><span class="p">(</span><span class="n">_mm_unpacklo_epi16</span><span class="p">(</span><span class="n">v19</span><span class="p">,</span> <span class="n">v19</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v17</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v20</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">dword_4053C4</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">v20</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
      <span class="n">v21</span> <span class="o">=</span> <span class="n">_mm_mullo_epi32</span><span class="p">(</span><span class="n">_mm_cvtepu8_epi32</span><span class="p">(</span><span class="n">_mm_cvtsi32_si128</span><span class="p">(</span><span class="n">v27</span><span class="p">.</span><span class="n">m128i_u32</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_404380</span><span class="p">);</span>
      <span class="n">xmmword_405018</span> <span class="o">=</span> <span class="p">(</span><span class="n">__int128</span><span class="p">)</span><span class="n">_mm_xor_si128</span><span class="p">(</span>
                                   <span class="n">_mm_add_epi32</span><span class="p">((</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_404340</span><span class="p">,</span> <span class="n">v9</span><span class="p">),</span>
                                   <span class="n">_mm_add_epi32</span><span class="p">(</span><span class="n">v21</span><span class="p">,</span> <span class="p">(</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_405018</span><span class="p">));</span>
      <span class="n">xmmword_405028</span> <span class="o">=</span> <span class="p">(</span><span class="n">__int128</span><span class="p">)</span><span class="n">_mm_xor_si128</span><span class="p">(</span>
                                   <span class="n">_mm_add_epi32</span><span class="p">(</span><span class="n">_mm_add_epi32</span><span class="p">((</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_404350</span><span class="p">,</span> <span class="p">(</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_404340</span><span class="p">),</span> <span class="n">v9</span><span class="p">),</span>
                                   <span class="n">_mm_add_epi32</span><span class="p">(</span><span class="n">v21</span><span class="p">,</span> <span class="p">(</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_405028</span><span class="p">));</span>
      <span class="n">xmmword_405038</span> <span class="o">=</span> <span class="p">(</span><span class="n">__int128</span><span class="p">)</span><span class="n">_mm_xor_si128</span><span class="p">(</span>
                                   <span class="n">_mm_add_epi32</span><span class="p">(</span><span class="n">_mm_add_epi32</span><span class="p">((</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_404360</span><span class="p">,</span> <span class="p">(</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_404340</span><span class="p">),</span> <span class="n">v9</span><span class="p">),</span>
                                   <span class="n">_mm_add_epi32</span><span class="p">(</span><span class="n">v21</span><span class="p">,</span> <span class="p">(</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_405038</span><span class="p">));</span>
      <span class="n">xmmword_405048</span> <span class="o">=</span> <span class="p">(</span><span class="n">__int128</span><span class="p">)</span><span class="n">_mm_xor_si128</span><span class="p">(</span>
                                   <span class="n">_mm_add_epi32</span><span class="p">(</span><span class="n">_mm_add_epi32</span><span class="p">((</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_404370</span><span class="p">,</span> <span class="p">(</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_404340</span><span class="p">),</span> <span class="n">v9</span><span class="p">),</span>
                                   <span class="n">_mm_add_epi32</span><span class="p">(</span><span class="n">v21</span><span class="p">,</span> <span class="p">(</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_405048</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">do</span>
    <span class="p">{</span>
      <span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">xmmword_405018</span> <span class="o">+</span> <span class="n">v20</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">v20</span> <span class="o">+</span> <span class="n">v3</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="mi">16843009</span> <span class="o">*</span> <span class="n">v11</span> <span class="o">+</span> <span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">xmmword_405018</span> <span class="o">+</span> <span class="n">v20</span><span class="p">));</span>
      <span class="o">++</span><span class="n">v20</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">while</span> <span class="p">(</span> <span class="n">v20</span> <span class="o">&lt;</span> <span class="mi">24</span> <span class="p">);</span>
    <span class="n">v22</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span> <span class="o">*</span><span class="p">((</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">xmmword_405018</span> <span class="o">+</span> <span class="n">v22</span><span class="p">)</span> <span class="o">==</span> <span class="o">*</span><span class="p">((</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">loc_404148</span> <span class="o">+</span> <span class="n">v22</span><span class="p">)</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span> <span class="o">++</span><span class="n">v22</span> <span class="o">&gt;=</span> <span class="mi">96</span> <span class="p">)</span>
      <span class="p">{</span>
        <span class="n">v28</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">v23</span> <span class="o">=</span> <span class="n">__rdtsc</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v23</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v26</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">v28</span> <span class="o">=</span> <span class="n">v23</span> <span class="o">-</span> <span class="n">v26</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)(</span><span class="n">v23</span> <span class="o">-</span> <span class="n">v26</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mh">0xFFFFFF</span><span class="p">)</span> <span class="p">)</span>
          <span class="n">MEMORY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">v24</span> <span class="o">=</span> <span class="n">GetCurrentProcess</span><span class="p">();</span>
        <span class="n">WriteProcessMemory</span><span class="p">(</span><span class="n">v24</span><span class="p">,</span> <span class="n">sub_4018A0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">xmmword_405018</span><span class="p">,</span> <span class="mh">0x60u</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>看不是特别懂，但也能从中读到一点东西。</p>
<p><code>if ( ++v4 &gt;= 8 )</code>可知输入字符串至少为8位</p>
<p>之后就直接动态调试了，这里用的是x32dbg</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mi">00401636</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">A343E</span>                      <span class="o">|</span> <span class="n">mov</span> <span class="n">dh</span><span class="p">,</span><span class="n">byte</span> <span class="n">ptr</span> <span class="n">ds</span><span class="p">:[</span><span class="n">esi</span><span class="o">+</span><span class="n">edi</span><span class="p">]</span>                 <span class="o">|</span>
<span class="mi">00401639</span>  <span class="o">|</span> <span class="mi">80</span><span class="n">FE</span> <span class="mi">30</span>                     <span class="o">|</span> <span class="n">cmp</span> <span class="n">dh</span><span class="p">,</span><span class="mi">30</span>                                    <span class="o">|</span> <span class="mi">30</span><span class="p">:</span><span class="s1">&#39;0&#39;</span>
<span class="mi">0040163</span><span class="k">C</span>  <span class="o">|</span> <span class="mi">7</span><span class="k">C</span> <span class="mi">0</span><span class="k">C</span>                       <span class="o">|</span> <span class="n">jl</span> <span class="n">justre</span><span class="p">.</span><span class="mi">40164</span><span class="n">A</span>                             <span class="o">|</span>
<span class="mi">0040163</span><span class="n">E</span>  <span class="o">|</span> <span class="mi">80</span><span class="n">FE</span> <span class="mi">39</span>                     <span class="o">|</span> <span class="n">cmp</span> <span class="n">dh</span><span class="p">,</span><span class="mi">39</span>                                    <span class="o">|</span> <span class="mi">39</span><span class="p">:</span><span class="s1">&#39;9&#39;</span>
<span class="mi">00401641</span>  <span class="o">|</span> <span class="mi">7</span><span class="n">F</span> <span class="mi">07</span>                       <span class="o">|</span> <span class="n">jg</span> <span class="n">justre</span><span class="p">.</span><span class="mi">40164</span><span class="n">A</span>                             <span class="o">|</span>
<span class="mi">00401643</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">AD6</span>                        <span class="o">|</span> <span class="n">mov</span> <span class="n">dl</span><span class="p">,</span><span class="n">dh</span>                                    <span class="o">|</span>
<span class="mi">00401645</span>  <span class="o">|</span> <span class="mi">80</span><span class="n">EA</span> <span class="mi">41</span>                     <span class="o">|</span> <span class="n">sub</span> <span class="n">dl</span><span class="p">,</span><span class="mi">41</span>                                    <span class="o">|</span>
<span class="mi">00401648</span>  <span class="o">|</span> <span class="n">EB</span> <span class="mi">0</span><span class="n">A</span>                       <span class="o">|</span> <span class="n">jmp</span> <span class="n">justre</span><span class="p">.</span><span class="mi">401654</span>                            <span class="o">|</span>
<span class="mi">0040164</span><span class="n">A</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">AD6</span>                        <span class="o">|</span> <span class="n">mov</span> <span class="n">dl</span><span class="p">,</span><span class="n">dh</span>                                    <span class="o">|</span>
<span class="mi">0040164</span><span class="k">C</span>  <span class="o">|</span> <span class="mi">80</span><span class="n">EA</span> <span class="mi">41</span>                     <span class="o">|</span> <span class="n">sub</span> <span class="n">dl</span><span class="p">,</span><span class="mi">41</span>                                    <span class="o">|</span>
<span class="mi">0040164</span><span class="n">F</span>  <span class="o">|</span> <span class="mi">80</span><span class="n">FA</span> <span class="mi">19</span>                     <span class="o">|</span> <span class="n">cmp</span> <span class="n">dl</span><span class="p">,</span><span class="mi">19</span>                                    <span class="o">|</span>
<span class="mi">00401652</span>  <span class="o">|</span> <span class="mi">77</span> <span class="mi">2</span><span class="k">C</span>                       <span class="o">|</span> <span class="n">ja</span> <span class="n">justre</span><span class="p">.</span><span class="mi">401680</span>                             <span class="o">|</span>
<span class="mi">00401654</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">ACE</span>                        <span class="o">|</span> <span class="n">mov</span> <span class="n">cl</span><span class="p">,</span><span class="n">dh</span>                                    <span class="o">|</span>
<span class="mi">00401656</span>  <span class="o">|</span> <span class="n">C1E0</span> <span class="mi">04</span>                     <span class="o">|</span> <span class="n">shl</span> <span class="n">eax</span><span class="p">,</span><span class="mi">4</span>                                    <span class="o">|</span>
<span class="mi">00401659</span>  <span class="o">|</span> <span class="mi">80</span><span class="n">E9</span> <span class="mi">30</span>                     <span class="o">|</span> <span class="n">sub</span> <span class="n">cl</span><span class="p">,</span><span class="mi">30</span>                                    <span class="o">|</span>
<span class="mi">0040165</span><span class="k">C</span>  <span class="o">|</span> <span class="mi">80</span><span class="n">F9</span> <span class="mi">09</span>                     <span class="o">|</span> <span class="n">cmp</span> <span class="n">cl</span><span class="p">,</span><span class="mi">9</span>                                     <span class="o">|</span> <span class="mi">9</span><span class="p">:</span><span class="s1">&#39;\t&#39;</span>
<span class="mi">0040165</span><span class="n">F</span>  <span class="o">|</span> <span class="mi">77</span> <span class="mi">05</span>                       <span class="o">|</span> <span class="n">ja</span> <span class="n">justre</span><span class="p">.</span><span class="mi">401666</span>                             <span class="o">|</span>
<span class="mi">00401661</span>  <span class="o">|</span> <span class="mi">83</span><span class="n">C0</span> <span class="n">D0</span>                     <span class="o">|</span> <span class="k">add</span> <span class="n">eax</span><span class="p">,</span><span class="n">FFFFFFD0</span>                             <span class="o">|</span>
<span class="mi">00401664</span>  <span class="o">|</span> <span class="n">EB</span> <span class="mi">08</span>                       <span class="o">|</span> <span class="n">jmp</span> <span class="n">justre</span><span class="p">.</span><span class="mi">40166</span><span class="n">E</span>                            <span class="o">|</span>
<span class="mi">00401666</span>  <span class="o">|</span> <span class="mi">80</span><span class="n">FA</span> <span class="mi">19</span>                     <span class="o">|</span> <span class="n">cmp</span> <span class="n">dl</span><span class="p">,</span><span class="mi">19</span>                                    <span class="o">|</span>
<span class="mi">00401669</span>  <span class="o">|</span> <span class="mi">77</span> <span class="mi">08</span>                       <span class="o">|</span> <span class="n">ja</span> <span class="n">justre</span><span class="p">.</span><span class="mi">401673</span>                             <span class="o">|</span>
<span class="mi">0040166</span><span class="n">B</span>  <span class="o">|</span> <span class="mi">83</span><span class="n">C0</span> <span class="n">C9</span>                     <span class="o">|</span> <span class="k">add</span> <span class="n">eax</span><span class="p">,</span><span class="n">FFFFFFC9</span>                             <span class="o">|</span>
<span class="mi">0040166</span><span class="n">E</span>  <span class="o">|</span> <span class="mi">0</span><span class="n">FBECE</span>                      <span class="o">|</span> <span class="n">movsx</span> <span class="n">ecx</span><span class="p">,</span><span class="n">dh</span>                                 <span class="o">|</span>
<span class="mi">00401671</span>  <span class="o">|</span> <span class="mi">03</span><span class="n">C1</span>                        <span class="o">|</span> <span class="k">add</span> <span class="n">eax</span><span class="p">,</span><span class="n">ecx</span>                                  <span class="o">|</span>
<span class="mi">00401673</span>  <span class="o">|</span> <span class="mi">46</span>                          <span class="o">|</span> <span class="n">inc</span> <span class="n">esi</span>                                      <span class="o">|</span>
<span class="mi">00401674</span>  <span class="o">|</span> <span class="mi">83</span><span class="n">FE</span> <span class="mi">08</span>                     <span class="o">|</span> <span class="n">cmp</span> <span class="n">esi</span><span class="p">,</span><span class="mi">8</span>                                    <span class="o">|</span>
<span class="mi">00401677</span>  <span class="o">|</span> <span class="mi">7</span><span class="k">C</span> <span class="n">BD</span>                       <span class="o">|</span> <span class="n">jl</span> <span class="n">justre</span><span class="p">.</span><span class="mi">401636</span>                             <span class="o">|</span>
</pre></div>
</td></tr></table>

<p>这里是判断函数的第一个循环，用黑盒直接猜测，这里是读取前8位字符到eax</p>
<p><img alt="1558934804066" src="https://raw.githubusercontent.com/Alikas0/files/master/img/1558934804066.png" /></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mi">00401682</span>  <span class="o">|</span> <span class="mi">66</span><span class="p">:</span><span class="mi">0</span><span class="n">F6EC0</span>                   <span class="o">|</span> <span class="n">movd</span> <span class="n">xmm0</span><span class="p">,</span><span class="n">eax</span>                                <span class="o">|</span>
<span class="mi">00401686</span>  <span class="o">|</span> <span class="mi">66</span><span class="p">:</span><span class="mi">0</span><span class="n">F70E8</span> <span class="mi">00</span>                <span class="o">|</span> <span class="n">pshufd</span> <span class="n">xmm5</span><span class="p">,</span><span class="n">xmm0</span><span class="p">,</span><span class="mi">0</span>                           <span class="o">|</span>
</pre></div>
</td></tr></table>

<p>这两句，将前八为扩展到xmm5中</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">xmm5</span>                <span class="mi">12345678123456781234567812345678</span>
</pre></div>
</td></tr></table>

<p>这一句，读取了后两位，所以从这里可以知道输入字符至少10位</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mi">00401693</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">A57</span> <span class="mi">08</span>                     <span class="o">|</span> <span class="n">mov</span> <span class="n">dl</span><span class="p">,</span><span class="n">byte</span> <span class="n">ptr</span> <span class="n">ds</span><span class="p">:[</span><span class="n">edi</span><span class="o">+</span><span class="mi">8</span><span class="p">]</span>                   <span class="o">|</span> <span class="n">edi</span><span class="o">+</span><span class="mi">8</span><span class="p">:</span><span class="ss">&quot;AB&quot;</span>
</pre></div>
</td></tr></table>

<p>继续黑盒，可知，在这几句之前的语句都是在执行将后两位读取到ecx中，而这几句则是将其扩展到xmm0中</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mi">00401728</span>  <span class="o">|</span> <span class="mi">0</span><span class="n">FBECE</span>                      <span class="o">|</span> <span class="n">movsx</span> <span class="n">ecx</span><span class="p">,</span><span class="n">dh</span>                                 <span class="o">|</span>
<span class="mi">0040172</span><span class="n">B</span>  <span class="o">|</span> <span class="mi">66</span><span class="p">:</span><span class="mi">0</span><span class="n">F6EC1</span>                   <span class="o">|</span> <span class="n">movd</span> <span class="n">xmm0</span><span class="p">,</span><span class="n">ecx</span>                                <span class="o">|</span>
<span class="mi">0040172</span><span class="n">F</span>  <span class="o">|</span> <span class="mi">66</span><span class="p">:</span><span class="mi">0</span><span class="n">F60C0</span>                   <span class="o">|</span> <span class="n">punpcklbw</span> <span class="n">xmm0</span><span class="p">,</span><span class="n">xmm0</span>                          <span class="o">|</span>
<span class="mi">00401733</span>  <span class="o">|</span> <span class="mi">66</span><span class="p">:</span><span class="mi">0</span><span class="n">F61C0</span>                   <span class="o">|</span> <span class="n">punpcklwd</span> <span class="n">xmm0</span><span class="p">,</span><span class="n">xmm0</span>                          <span class="o">|</span>
<span class="mi">00401737</span>  <span class="o">|</span> <span class="mi">66</span><span class="p">:</span><span class="mi">0</span><span class="n">F70C0</span> <span class="mi">00</span>                <span class="o">|</span> <span class="n">pshufd</span> <span class="n">xmm0</span><span class="p">,</span><span class="n">xmm0</span><span class="p">,</span><span class="mi">0</span>                           <span class="o">|</span>
<span class="mi">0040173</span><span class="k">C</span>  <span class="o">|</span> <span class="mi">0</span><span class="n">F2945</span> <span class="n">E0</span>                   <span class="o">|</span> <span class="n">movaps</span> <span class="n">xmmword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">ebp</span><span class="o">-</span><span class="mi">20</span><span class="p">],</span><span class="n">xmm0</span>          <span class="o">|</span>
</pre></div>
</td></tr></table>

<p><img alt="1558935387042" src="https://raw.githubusercontent.com/Alikas0/files/master/img/1558935387042.png" /></p>
<p>接下来由单步调试就可知,将下面，每次读取16个16进制字符进行运算(最后两组是分别进行，每次读取4个16进制字符)：</p>
<p>先分别加上后两位，这里就是加上AB，再每八位，和前八位加上i的数异或后再送回[00405018]</p>
<p>例如：3E5F11D5FE0F0B1DEA90BD987BB39408加上ABABABABABABABABABABABABABABABAB，在和12345678123456781234567812345678加上00000003000000020000000100000000后的1234567B1234567A1234567912345678异或后得F83EEBFBBB8EE0B284083F3A356B69CB，然后送回[00405018]</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mi">00405010</span>                          <span class="mi">08</span> <span class="mi">94</span> <span class="n">B3</span> <span class="mi">7</span><span class="n">B</span> <span class="mi">98</span> <span class="n">BD</span> <span class="mi">90</span> <span class="n">EA</span>  <span class="o">/</span><span class="p">.........</span><span class="err">³{</span><span class="p">.</span><span class="err">½</span><span class="p">.</span><span class="err">ê</span>  
<span class="mi">00405020</span>  <span class="mi">1</span><span class="n">D</span> <span class="mi">0</span><span class="n">B</span> <span class="mi">0</span><span class="n">F</span> <span class="n">FE</span> <span class="n">D5</span> <span class="mi">11</span> <span class="mi">5</span><span class="n">F</span> <span class="mi">3</span><span class="n">E</span> <span class="mi">37</span> <span class="n">FC</span> <span class="n">CA</span> <span class="mi">85</span> <span class="n">B4</span> <span class="n">F1</span> <span class="mi">3</span><span class="n">A</span> <span class="n">FC</span>  <span class="p">...</span><span class="err">þÕ</span><span class="p">.</span><span class="n">_</span><span class="o">&gt;</span><span class="mi">7</span><span class="err">üÊ</span><span class="p">.</span><span class="err">´ñ</span><span class="p">:</span><span class="err">ü</span>  
<span class="mi">00405030</span>  <span class="mi">39</span> <span class="mi">0</span><span class="n">D</span> <span class="mi">16</span> <span class="n">EE</span> <span class="mi">35</span> <span class="mi">75</span> <span class="mi">50</span> <span class="mi">3</span><span class="n">E</span> <span class="mi">3</span><span class="n">B</span> <span class="mi">6</span><span class="n">D</span> <span class="n">CF</span> <span class="mi">3</span><span class="n">D</span> <span class="n">FC</span> <span class="mi">0</span><span class="k">C</span> <span class="mi">5</span><span class="n">D</span> <span class="mi">07</span>  <span class="mi">9</span><span class="p">..</span><span class="err">î</span><span class="mi">5</span><span class="n">uP</span><span class="o">&gt;</span><span class="p">;</span><span class="n">mÏ</span><span class="o">=</span><span class="err">ü</span><span class="p">.].</span>  
<span class="mi">00405040</span>  <span class="mi">2</span><span class="n">E</span> <span class="mi">51</span> <span class="n">EB</span> <span class="mi">29</span> <span class="n">EF</span> <span class="n">BB</span> <span class="mi">16</span> <span class="mi">58</span> <span class="mi">3</span><span class="k">C</span> <span class="mi">85</span> <span class="mi">50</span> <span class="mi">3</span><span class="n">E</span> <span class="mi">40</span> <span class="mi">2</span><span class="n">F</span> <span class="mi">16</span> <span class="n">B0</span>  <span class="p">.</span><span class="n">Që</span><span class="p">)</span><span class="err">ï»</span><span class="p">.</span><span class="n">X</span><span class="o">&lt;</span><span class="p">.</span><span class="n">P</span><span class="o">&gt;@/</span><span class="p">.</span><span class="err">°</span>  
<span class="mi">00405050</span>  <span class="n">FD</span> <span class="n">F0</span> <span class="mi">4</span><span class="n">E</span> <span class="mi">07</span> <span class="mi">32</span> <span class="mi">4</span><span class="n">E</span> <span class="mi">19</span> <span class="mi">64</span> <span class="mi">03</span> <span class="mi">95</span> <span class="mi">4</span><span class="n">B</span> <span class="mi">22</span> <span class="mi">00</span> <span class="mi">9</span><span class="n">A</span> <span class="mi">8</span><span class="n">B</span> <span class="mi">22</span>  <span class="err">ýð</span><span class="n">N</span><span class="p">.</span><span class="mi">2</span><span class="n">N</span><span class="p">.</span><span class="n">d</span><span class="p">..</span><span class="n">K</span><span class="ss">&quot;...&quot;</span>  
<span class="mi">00405060</span>  <span class="mi">91</span> <span class="mi">0</span><span class="n">E</span> <span class="mi">0</span><span class="n">F</span> <span class="n">FE</span> <span class="mi">1</span><span class="k">C</span> <span class="mi">0</span><span class="n">D</span> <span class="mi">5</span><span class="n">F</span> <span class="mi">07</span> <span class="mi">38</span> <span class="mi">51</span> <span class="n">EB</span> <span class="n">F9</span> <span class="n">A0</span> <span class="mi">65</span> <span class="mi">16</span> <span class="n">FE</span>  <span class="p">...</span><span class="err">þ</span><span class="p">..</span><span class="n">_</span><span class="p">.</span><span class="mi">8</span><span class="n">Qëù</span> <span class="n">e</span><span class="p">.</span><span class="err">þ</span>  
<span class="mi">00405070</span>  <span class="mi">49</span> <span class="mi">33</span> <span class="mi">4</span><span class="n">F</span> <span class="mi">89</span> <span class="n">C6</span> <span class="n">F1</span> <span class="mi">56</span> <span class="n">FC</span>                          <span class="n">I3O</span><span class="p">.</span><span class="err">Æñ</span><span class="n">Vü</span>
<span class="n">_____________________________________________________________________________</span>
<span class="mi">00405010</span>                          <span class="n">CB</span> <span class="mi">69</span> <span class="mi">6</span><span class="n">B</span> <span class="mi">35</span> <span class="mi">3</span><span class="n">A</span> <span class="mi">3</span><span class="n">F</span> <span class="mi">08</span> <span class="mi">84</span>  <span class="o">/</span><span class="p">.......</span><span class="err">Ë</span><span class="n">ik5</span><span class="p">:</span><span class="o">?</span><span class="p">..</span>  
<span class="mi">00405020</span>  <span class="n">B2</span> <span class="n">E0</span> <span class="mi">8</span><span class="n">E</span> <span class="n">BB</span> <span class="n">FB</span> <span class="n">EB</span> <span class="mi">3</span><span class="n">E</span> <span class="n">F8</span> <span class="mi">37</span> <span class="n">FC</span> <span class="n">CA</span> <span class="mi">85</span> <span class="n">B4</span> <span class="n">F1</span> <span class="mi">3</span><span class="n">A</span> <span class="n">FC</span>  <span class="err">²à</span><span class="p">.</span><span class="err">»ûë</span><span class="o">&gt;</span><span class="err">ø</span><span class="mi">7</span><span class="err">üÊ</span><span class="p">.</span><span class="err">´ñ</span><span class="p">:</span><span class="err">ü</span>  
<span class="mi">00405030</span>  <span class="mi">39</span> <span class="mi">0</span><span class="n">D</span> <span class="mi">16</span> <span class="n">EE</span> <span class="mi">35</span> <span class="mi">75</span> <span class="mi">50</span> <span class="mi">3</span><span class="n">E</span> <span class="mi">3</span><span class="n">B</span> <span class="mi">6</span><span class="n">D</span> <span class="n">CF</span> <span class="mi">3</span><span class="n">D</span> <span class="n">FC</span> <span class="mi">0</span><span class="k">C</span> <span class="mi">5</span><span class="n">D</span> <span class="mi">07</span>  <span class="mi">9</span><span class="p">..</span><span class="err">î</span><span class="mi">5</span><span class="n">uP</span><span class="o">&gt;</span><span class="p">;</span><span class="n">mÏ</span><span class="o">=</span><span class="err">ü</span><span class="p">.].</span>  
<span class="mi">00405040</span>  <span class="mi">2</span><span class="n">E</span> <span class="mi">51</span> <span class="n">EB</span> <span class="mi">29</span> <span class="n">EF</span> <span class="n">BB</span> <span class="mi">16</span> <span class="mi">58</span> <span class="mi">3</span><span class="k">C</span> <span class="mi">85</span> <span class="mi">50</span> <span class="mi">3</span><span class="n">E</span> <span class="mi">40</span> <span class="mi">2</span><span class="n">F</span> <span class="mi">16</span> <span class="n">B0</span>  <span class="p">.</span><span class="n">Që</span><span class="p">)</span><span class="err">ï»</span><span class="p">.</span><span class="n">X</span><span class="o">&lt;</span><span class="p">.</span><span class="n">P</span><span class="o">&gt;@/</span><span class="p">.</span><span class="err">°</span>  
<span class="mi">00405050</span>  <span class="n">FD</span> <span class="n">F0</span> <span class="mi">4</span><span class="n">E</span> <span class="mi">07</span> <span class="mi">32</span> <span class="mi">4</span><span class="n">E</span> <span class="mi">19</span> <span class="mi">64</span> <span class="mi">03</span> <span class="mi">95</span> <span class="mi">4</span><span class="n">B</span> <span class="mi">22</span> <span class="mi">00</span> <span class="mi">9</span><span class="n">A</span> <span class="mi">8</span><span class="n">B</span> <span class="mi">22</span>  <span class="err">ýð</span><span class="n">N</span><span class="p">.</span><span class="mi">2</span><span class="n">N</span><span class="p">.</span><span class="n">d</span><span class="p">..</span><span class="n">K</span><span class="ss">&quot;...&quot;</span>  
<span class="mi">00405060</span>  <span class="mi">91</span> <span class="mi">0</span><span class="n">E</span> <span class="mi">0</span><span class="n">F</span> <span class="n">FE</span> <span class="mi">1</span><span class="k">C</span> <span class="mi">0</span><span class="n">D</span> <span class="mi">5</span><span class="n">F</span> <span class="mi">07</span> <span class="mi">38</span> <span class="mi">51</span> <span class="n">EB</span> <span class="n">F9</span> <span class="n">A0</span> <span class="mi">65</span> <span class="mi">16</span> <span class="n">FE</span>  <span class="p">...</span><span class="err">þ</span><span class="p">..</span><span class="n">_</span><span class="p">.</span><span class="mi">8</span><span class="n">Qëù</span> <span class="n">e</span><span class="p">.</span><span class="err">þ</span>  
<span class="mi">00405070</span>  <span class="mi">49</span> <span class="mi">33</span> <span class="mi">4</span><span class="n">F</span> <span class="mi">89</span> <span class="n">C6</span> <span class="n">F1</span> <span class="mi">56</span> <span class="n">FC</span>                          <span class="n">I3O</span><span class="p">.</span><span class="err">Æñ</span><span class="n">Vü</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mi">00401831</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">A81</span> <span class="mi">18504000</span>               <span class="o">|</span> <span class="n">mov</span> <span class="n">al</span><span class="p">,</span><span class="n">byte</span> <span class="n">ptr</span> <span class="n">ds</span><span class="p">:[</span><span class="n">ecx</span><span class="o">+</span><span class="mi">405018</span><span class="p">]</span>              <span class="o">|</span>
<span class="mi">00401837</span>  <span class="o">|</span> <span class="mi">3</span><span class="n">A81</span> <span class="mi">48414000</span>               <span class="o">|</span> <span class="n">cmp</span> <span class="n">al</span><span class="p">,</span><span class="n">byte</span> <span class="n">ptr</span> <span class="n">ds</span><span class="p">:[</span><span class="n">ecx</span><span class="o">+</span><span class="mi">404148</span><span class="p">]</span>              <span class="o">|</span>
<span class="mi">0040183</span><span class="n">D</span>  <span class="o">|</span> <span class="mi">75</span> <span class="mi">4</span><span class="n">F</span>                       <span class="o">|</span> <span class="n">jne</span> <span class="n">justre</span><span class="p">.</span><span class="mi">40188</span><span class="n">E</span>                            <span class="o">|</span>
<span class="mi">0040183</span><span class="n">F</span>  <span class="o">|</span> <span class="mi">41</span>                          <span class="o">|</span> <span class="n">inc</span> <span class="n">ecx</span>                                      <span class="o">|</span>
<span class="mi">00401840</span>  <span class="o">|</span> <span class="mi">83</span><span class="n">F9</span> <span class="mi">60</span>                     <span class="o">|</span> <span class="n">cmp</span> <span class="n">ecx</span><span class="p">,</span><span class="mi">60</span>                                   <span class="o">|</span>
<span class="mi">00401843</span>  <span class="o">|</span> <span class="mi">7</span><span class="k">C</span> <span class="n">EC</span>                       <span class="o">|</span> <span class="n">jl</span> <span class="n">justre</span><span class="p">.</span><span class="mi">401831</span>                             <span class="o">|</span>
</pre></div>
</td></tr></table>

<p>上面这几句则是将运算后的字符和[404148]处的字符进行对比，即是主函数中的（一开始IDA给识别成了语句，直接undifine即可）</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">;</span> <span class="nt">_BYTE</span> <span class="nt">byte_404148</span><span class="cp">[</span><span class="mi">96</span><span class="cp">]</span>
<span class="p">.</span><span class="nc">rdata</span><span class="p">:</span><span class="nd">00404148</span> <span class="nt">byte_404148</span>     <span class="nt">db</span> <span class="nt">55h</span><span class="o">,</span> <span class="nt">8Bh</span><span class="o">,</span> <span class="nt">0ECh</span><span class="o">,</span> <span class="nt">83h</span><span class="o">,</span> <span class="nt">0E4h</span><span class="o">,</span> <span class="nt">0F0h</span><span class="o">,</span> <span class="nt">81h</span><span class="o">,</span> <span class="nt">0ECh</span><span class="o">,</span> <span class="nt">78h</span><span class="o">,</span> <span class="nt">2</span>
<span class="p">.</span><span class="nc">rdata</span><span class="p">:</span><span class="nd">00404148</span>                                         <span class="o">;</span> <span class="nt">DATA</span> <span class="nt">XREF</span><span class="o">:</span> <span class="nt">sub_401610</span><span class="o">+</span><span class="nt">227</span><span class="err">↑</span><span class="nt">r</span>
<span class="p">.</span><span class="nc">rdata</span><span class="p">:</span><span class="nd">00404148</span>                 <span class="nt">db</span> <span class="nt">2</span> <span class="nt">dup</span><span class="o">(</span><span class="nt">0</span><span class="o">),</span> <span class="nt">0A1h</span><span class="o">,</span> <span class="nt">4</span><span class="o">,</span> <span class="nt">50h</span><span class="o">,</span> <span class="nt">40h</span><span class="o">,</span> <span class="nt">0</span><span class="o">,</span> <span class="nt">33h</span><span class="o">,</span> <span class="nt">0C4h</span><span class="o">,</span> <span class="nt">89h</span><span class="o">,</span> <span class="nt">84h</span>
<span class="p">.</span><span class="nc">rdata</span><span class="p">:</span><span class="nd">00404148</span>                 <span class="nt">db</span> <span class="nt">24h</span><span class="o">,</span> <span class="nt">74h</span><span class="o">,</span> <span class="nt">2</span><span class="o">,</span> <span class="nt">2</span> <span class="nt">dup</span><span class="o">(</span><span class="nt">0</span><span class="o">),</span> <span class="nt">0Fh</span><span class="o">,</span> <span class="nt">10h</span><span class="o">,</span> <span class="nt">5</span><span class="o">,</span> <span class="nt">0A8h</span><span class="o">,</span> <span class="nt">41h</span><span class="o">,</span> <span class="nt">40h</span>
<span class="p">.</span><span class="nc">rdata</span><span class="p">:</span><span class="nd">00404148</span>                 <span class="nt">db</span> <span class="nt">0</span><span class="o">,</span> <span class="nt">0A0h</span><span class="o">,</span> <span class="nt">0C0h</span><span class="o">,</span> <span class="nt">41h</span><span class="o">,</span> <span class="nt">40h</span><span class="o">,</span> <span class="nt">0</span><span class="o">,</span> <span class="nt">56h</span><span class="o">,</span> <span class="nt">0Fh</span><span class="o">,</span> <span class="nt">11h</span><span class="o">,</span> <span class="nt">44h</span><span class="o">,</span> <span class="nt">24h</span>
<span class="p">.</span><span class="nc">rdata</span><span class="p">:</span><span class="nd">00404148</span>                 <span class="nt">db</span> <span class="nt">2Ch</span><span class="o">,</span> <span class="nt">57h</span><span class="o">,</span> <span class="nt">0F3h</span><span class="o">,</span> <span class="nt">0Fh</span><span class="o">,</span> <span class="nt">7Eh</span><span class="o">,</span> <span class="nt">5</span><span class="o">,</span> <span class="nt">0B8h</span><span class="o">,</span> <span class="nt">41h</span><span class="o">,</span> <span class="nt">40h</span><span class="o">,</span> <span class="nt">0</span><span class="o">,</span> <span class="nt">66h</span>
<span class="p">.</span><span class="nc">rdata</span><span class="p">:</span><span class="nd">00404148</span>                 <span class="nt">db</span> <span class="nt">0Fh</span><span class="o">,</span> <span class="nt">0D6h</span><span class="o">,</span> <span class="nt">44h</span><span class="o">,</span> <span class="nt">24h</span><span class="o">,</span> <span class="nt">40h</span><span class="o">,</span> <span class="nt">0Fh</span><span class="o">,</span> <span class="nt">10h</span><span class="o">,</span> <span class="nt">41h</span><span class="o">,</span> <span class="nt">0Ah</span><span class="o">,</span> <span class="nt">6Ah</span><span class="o">,</span> <span class="nt">40h</span>
<span class="p">.</span><span class="nc">rdata</span><span class="p">:</span><span class="nd">00404148</span>                 <span class="nt">db</span> <span class="nt">88h</span><span class="o">,</span> <span class="nt">44h</span><span class="o">,</span> <span class="nt">24h</span><span class="o">,</span> <span class="nt">4Ch</span><span class="o">,</span> <span class="nt">8Dh</span><span class="o">,</span> <span class="nt">84h</span><span class="o">,</span> <span class="nt">24h</span><span class="o">,</span> <span class="nt">0FCh</span><span class="o">,</span> <span class="nt">1</span><span class="o">,</span> <span class="nt">2</span> <span class="nt">dup</span><span class="o">(</span><span class="nt">0</span><span class="o">)</span>
<span class="p">.</span><span class="nc">rdata</span><span class="p">:</span><span class="nd">00404148</span>                 <span class="nt">db</span> <span class="nt">6Ah</span><span class="o">,</span> <span class="nt">0</span><span class="o">,</span> <span class="nt">50h</span><span class="o">,</span> <span class="nt">0Fh</span><span class="o">,</span> <span class="nt">11h</span><span class="o">,</span> <span class="nt">44h</span><span class="o">,</span> <span class="nt">24h</span><span class="o">,</span> <span class="nt">1Ch</span><span class="o">,</span> <span class="nt">0E8h</span><span class="o">,</span> <span class="nt">58h</span><span class="o">,</span> <span class="nt">0Fh</span>
<span class="p">.</span><span class="nc">rdata</span><span class="p">:</span><span class="nd">00404148</span>                 <span class="nt">db</span> <span class="nt">2</span> <span class="nt">dup</span><span class="o">(</span><span class="nt">0</span><span class="o">),</span> <span class="nt">6Ah</span><span class="o">,</span> <span class="nt">40h</span><span class="o">,</span> <span class="nt">8Dh</span><span class="o">,</span> <span class="nt">84h</span><span class="o">,</span> <span class="nt">24h</span><span class="o">,</span> <span class="nt">48h</span><span class="o">,</span> <span class="nt">2</span>
<span class="p">.</span><span class="nc">rdata</span><span class="p">:</span><span class="nd">004041A8</span>                 <span class="nt">xmmword</span> <span class="nt">4E434158435843594445434641534641h</span>
<span class="p">.</span><span class="nc">rdata</span><span class="p">:</span><span class="nd">004041B8</span>                 <span class="nt">dq</span> <span class="nt">43585143444B4644h</span>
<span class="p">.</span><span class="nc">rdata</span><span class="p">:</span><span class="nd">004041C0</span>                 <span class="nt">db</span> <span class="nt">0</span>
</pre></div>
</td></tr></table>

<p>知道了运算过程，那就可以来解出前10位：我这里通过先求出前八位,再求出后两位的方法</p>
<p>因为前八位，对相邻的4个16进制数操作相差为1，则可通过最初的两位求出满足条件的8位数,再相减求出满足相差为1的且参与运算的后两位是相同的前八位，再通过已知前八位来算出后两位</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x8B</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">]</span>

<span class="n">aa</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mh">0xFF</span><span class="p">):</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0xB3</span><span class="p">,</span> <span class="mh">0x7B</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">s1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">i</span>
    <span class="n">key2</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="mh">0XFFFFFFF</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">key</span> <span class="o">^</span> <span class="n">key2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mh">0xFFFFFFFF</span><span class="p">:</span>
        <span class="n">aa</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span> <span class="o">^</span> <span class="n">key2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">aa</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xE4</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">]</span>

<span class="n">bb</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mh">0xFF</span><span class="p">):</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x98</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">s1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">i</span>
    <span class="n">key2</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="mh">0XFFFFFFF</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">key</span> <span class="o">^</span> <span class="n">key2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mh">0xFFFFFFFF</span><span class="p">:</span>
        <span class="n">bb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span> <span class="o">^</span> <span class="n">key2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">aa</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">aa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">bb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">aa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">print</span> <span class="nb">hex</span><span class="p">(</span><span class="n">aa</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">break</span>

<span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xE4</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">]</span>
<span class="n">s1</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x98</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">]</span>
<span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">key2</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">print</span> <span class="nb">hex</span><span class="p">((</span><span class="n">key</span> <span class="o">^</span> <span class="n">bb</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">key2</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>最终得到：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mi">0</span><span class="n">x13242248L</span>
<span class="mi">0</span><span class="n">x15151515L</span>
</pre></div>
</td></tr></table>

<p>即前10位为<code>1324224815</code>，但输进去还是sorry，那就是后面还有一些东西</p>
<p>继续调试：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mi">00401862</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="mi">8900</span><span class="w">                        </span><span class="o">|</span><span class="w"> </span><span class="n">mov</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="nl">ds</span><span class="p">:</span><span class="o">[</span><span class="n">eax</span><span class="o">]</span><span class="p">,</span><span class="n">eax</span><span class="w">                   </span><span class="o">|</span><span class="w"></span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span> <span class="k">if</span> <span class="p">(</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v23</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v26</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">v28</span> <span class="o">=</span> <span class="n">v23</span> <span class="o">-</span> <span class="n">v26</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)(</span><span class="n">v23</span> <span class="o">-</span> <span class="n">v26</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mh">0xFFFFFF</span><span class="p">)</span> <span class="p">)</span>
          <span class="n">MEMORY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</pre></div>
</td></tr></table>

<p>调试到这里程序会崩溃，根据IDA这里MEMORY[0] = 0也是分析不出来的，直接设下一句为新EIP即可</p>
<p>接着开始瞎猜模式.......</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mi">00401949</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">B8424</span> <span class="n">F8010000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="n">F8</span><span class="p">]</span>               <span class="o">|</span>
<span class="mi">00401950</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">D9424</span> <span class="mi">70010000</span>             <span class="o">|</span> <span class="n">lea</span> <span class="n">edx</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">170</span><span class="p">]</span>               <span class="o">|</span>
<span class="mi">00401957</span>  <span class="o">|</span> <span class="mi">83</span><span class="n">C4</span> <span class="mi">18</span>                     <span class="o">|</span> <span class="k">add</span> <span class="n">esp</span><span class="p">,</span><span class="mi">18</span>                                   <span class="o">|</span>
<span class="mi">0040195</span><span class="n">A</span>  <span class="o">|</span> <span class="mi">898424</span> <span class="n">D8010000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="n">D8</span><span class="p">],</span><span class="n">eax</span>               <span class="o">|</span>
<span class="mi">00401961</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">B8424</span> <span class="n">E4010000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="n">E4</span><span class="p">]</span>               <span class="o">|</span>
<span class="mi">00401968</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">D8C24</span> <span class="n">D8010000</span>             <span class="o">|</span> <span class="n">lea</span> <span class="n">ecx</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="n">D8</span><span class="p">]</span>               <span class="o">|</span>
<span class="mi">0040196</span><span class="n">F</span>  <span class="o">|</span> <span class="mi">898424</span> <span class="n">DC010000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="n">DC</span><span class="p">],</span><span class="n">eax</span>               <span class="o">|</span>
<span class="mi">00401976</span>  <span class="o">|</span> <span class="n">E8</span> <span class="mi">85</span><span class="n">F6FFFF</span>                 <span class="o">|</span> <span class="k">call</span> <span class="o">&lt;</span><span class="n">justre</span><span class="p">.</span><span class="n">sub_401000</span><span class="o">&gt;</span>                     <span class="o">|</span>
<span class="mi">0040197</span><span class="n">B</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">B8424</span> <span class="n">E8010000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="n">E8</span><span class="p">]</span>               <span class="o">|</span>
<span class="mi">00401982</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">D9424</span> <span class="n">D8000000</span>             <span class="o">|</span> <span class="n">lea</span> <span class="n">edx</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="n">D8</span><span class="p">]</span>                <span class="o">|</span>
<span class="mi">00401989</span>  <span class="o">|</span> <span class="mi">898424</span> <span class="n">D8010000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="n">D8</span><span class="p">],</span><span class="n">eax</span>               <span class="o">|</span>
<span class="mi">00401990</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">D8C24</span> <span class="n">D8010000</span>             <span class="o">|</span> <span class="n">lea</span> <span class="n">ecx</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="n">D8</span><span class="p">]</span>               <span class="o">|</span>
<span class="mi">00401997</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">B8424</span> <span class="n">EC010000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="n">EC</span><span class="p">]</span>               <span class="o">|</span>
<span class="mi">0040199</span><span class="n">E</span>  <span class="o">|</span> <span class="mi">898424</span> <span class="n">DC010000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="n">DC</span><span class="p">],</span><span class="n">eax</span>               <span class="o">|</span>
<span class="mi">004019</span><span class="n">A5</span>  <span class="o">|</span> <span class="n">E8</span> <span class="mi">56</span><span class="n">F6FFFF</span>                 <span class="o">|</span> <span class="k">call</span> <span class="o">&lt;</span><span class="n">justre</span><span class="p">.</span><span class="n">sub_401000</span><span class="o">&gt;</span>                     <span class="o">|</span>
<span class="mi">004019</span><span class="n">AA</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">B8424</span> <span class="n">F0010000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="n">F0</span><span class="p">]</span>               <span class="o">|</span>
<span class="mi">004019</span><span class="n">B1</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">D5424</span> <span class="mi">58</span>                   <span class="o">|</span> <span class="n">lea</span> <span class="n">edx</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">58</span><span class="p">]</span>                <span class="o">|</span>
<span class="mi">004019</span><span class="n">B5</span>  <span class="o">|</span> <span class="mi">898424</span> <span class="n">D8010000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="n">D8</span><span class="p">],</span><span class="n">eax</span>               <span class="o">|</span>
<span class="mi">004019</span><span class="n">BC</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">D8C24</span> <span class="n">D8010000</span>             <span class="o">|</span> <span class="n">lea</span> <span class="n">ecx</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="n">D8</span><span class="p">]</span>               <span class="o">|</span>
<span class="mi">004019</span><span class="n">C3</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">B8424</span> <span class="n">F4010000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="n">F4</span><span class="p">]</span>               <span class="o">|</span>
<span class="mi">004019</span><span class="n">CA</span>  <span class="o">|</span> <span class="mi">898424</span> <span class="n">DC010000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="n">DC</span><span class="p">],</span><span class="n">eax</span>               <span class="o">|</span>
<span class="mi">004019</span><span class="n">D1</span>  <span class="o">|</span> <span class="n">E8</span> <span class="mi">2</span><span class="n">AF6FFFF</span>                 <span class="o">|</span> <span class="k">call</span> <span class="o">&lt;</span><span class="n">justre</span><span class="p">.</span><span class="n">sub_401000</span><span class="o">&gt;</span>                     <span class="o">|</span>
<span class="mi">004019</span><span class="n">D6</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">D7424</span> <span class="mi">10</span>                   <span class="o">|</span> <span class="n">lea</span> <span class="n">esi</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">10</span><span class="p">]</span>                <span class="o">|</span>
<span class="mi">004019</span><span class="n">DA</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">D4E</span> <span class="mi">01</span>                     <span class="o">|</span> <span class="n">lea</span> <span class="n">ecx</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span> <span class="n">ds</span><span class="p">:[</span><span class="n">esi</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>                 <span class="o">|</span>
</pre></div>
</td></tr></table>

<p>通过这几个语句，将读进来的<code>AFSAFCEDYCXCXACNDFKDCQXC</code>分成三部分，并每部分都往前填充成一个新的字符串</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="ss">&quot;AFSAFCEDAFSAFCEDYCXCXACNDFKDCQXC&quot;</span>
<span class="ss">&quot;YCXCFACNAFSAFCEDYCXCXACNDFKDCQXC&quot;</span>
<span class="ss">&quot;DFKDCQXCAFSAFCEDYCXCXACNDFKDCQXC&quot;</span>
</pre></div>
</td></tr></table>

<p>中间这里，在前十位后由读进来了16个字符，并转化成16个16进制数，通过<code>call &lt;justre.sub_401500&gt;</code>加密，并且是分成两块进行加密，每次加密64位，加密运算后存储</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mi">00401</span><span class="n">A50</span>  <span class="o">|</span> <span class="mi">0</span><span class="n">FB68434</span> <span class="n">F9010000</span>           <span class="o">|</span> <span class="n">movzx</span> <span class="n">eax</span><span class="p">,</span><span class="n">byte</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="n">esi</span><span class="o">+</span><span class="mi">1</span><span class="n">F9</span><span class="p">]</span>          <span class="o">|</span>
<span class="mi">00401</span><span class="n">A58</span>  <span class="o">|</span> <span class="mi">0</span><span class="n">FB68C34</span> <span class="n">F8010000</span>           <span class="o">|</span> <span class="n">movzx</span> <span class="n">ecx</span><span class="p">,</span><span class="n">byte</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="n">esi</span><span class="o">+</span><span class="mi">1</span><span class="n">F8</span><span class="p">]</span>          <span class="o">|</span>
<span class="mi">00401</span><span class="n">A60</span>  <span class="o">|</span> <span class="mi">0</span><span class="n">FB69434</span> <span class="n">FC010000</span>           <span class="o">|</span> <span class="n">movzx</span> <span class="n">edx</span><span class="p">,</span><span class="n">byte</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="n">esi</span><span class="o">+</span><span class="mi">1</span><span class="n">FC</span><span class="p">]</span>          <span class="o">|</span>
<span class="mi">00401</span><span class="n">A68</span>  <span class="o">|</span> <span class="n">C1E0</span> <span class="mi">08</span>                     <span class="o">|</span> <span class="n">shl</span> <span class="n">eax</span><span class="p">,</span><span class="mi">8</span>                                    <span class="o">|</span>
<span class="mi">00401</span><span class="n">A6B</span>  <span class="o">|</span> <span class="mi">0</span><span class="n">BC8</span>                        <span class="o">|</span> <span class="k">or</span> <span class="n">ecx</span><span class="p">,</span><span class="n">eax</span>                                   <span class="o">|</span>
<span class="mi">00401</span><span class="n">A6D</span>  <span class="o">|</span> <span class="mi">0</span><span class="n">FB68434</span> <span class="n">FA010000</span>           <span class="o">|</span> <span class="n">movzx</span> <span class="n">eax</span><span class="p">,</span><span class="n">byte</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="n">esi</span><span class="o">+</span><span class="mi">1</span><span class="n">FA</span><span class="p">]</span>          <span class="o">|</span>
<span class="mi">00401</span><span class="n">A75</span>  <span class="o">|</span> <span class="n">C1E0</span> <span class="mi">10</span>                     <span class="o">|</span> <span class="n">shl</span> <span class="n">eax</span><span class="p">,</span><span class="mi">10</span>                                   <span class="o">|</span>
<span class="mi">00401</span><span class="n">A78</span>  <span class="o">|</span> <span class="mi">0</span><span class="n">BC8</span>                        <span class="o">|</span> <span class="k">or</span> <span class="n">ecx</span><span class="p">,</span><span class="n">eax</span>                                   <span class="o">|</span>
<span class="mi">00401</span><span class="n">A7A</span>  <span class="o">|</span> <span class="mi">0</span><span class="n">FB68434</span> <span class="n">FB010000</span>           <span class="o">|</span> <span class="n">movzx</span> <span class="n">eax</span><span class="p">,</span><span class="n">byte</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="n">esi</span><span class="o">+</span><span class="mi">1</span><span class="n">FB</span><span class="p">]</span>          <span class="o">|</span>
<span class="mi">00401</span><span class="n">A82</span>  <span class="o">|</span> <span class="n">C1E0</span> <span class="mi">18</span>                     <span class="o">|</span> <span class="n">shl</span> <span class="n">eax</span><span class="p">,</span><span class="mi">18</span>                                   <span class="o">|</span>
<span class="mi">00401</span><span class="n">A85</span>  <span class="o">|</span> <span class="mi">0</span><span class="n">BC8</span>                        <span class="o">|</span> <span class="k">or</span> <span class="n">ecx</span><span class="p">,</span><span class="n">eax</span>                                   <span class="o">|</span>
<span class="mi">00401</span><span class="n">A87</span>  <span class="o">|</span> <span class="mi">0</span><span class="n">FB68434</span> <span class="n">FD010000</span>           <span class="o">|</span> <span class="n">movzx</span> <span class="n">eax</span><span class="p">,</span><span class="n">byte</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="n">esi</span><span class="o">+</span><span class="mi">1</span><span class="n">FD</span><span class="p">]</span>          <span class="o">|</span>
<span class="mi">00401</span><span class="n">A8F</span>  <span class="o">|</span> <span class="mi">898</span><span class="n">C24</span> <span class="n">D8010000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="n">D8</span><span class="p">],</span><span class="n">ecx</span>               <span class="o">|</span>
<span class="mi">00401</span><span class="n">A96</span>  <span class="o">|</span> <span class="mi">0</span><span class="n">FB68C34</span> <span class="n">FF010000</span>           <span class="o">|</span> <span class="n">movzx</span> <span class="n">ecx</span><span class="p">,</span><span class="n">byte</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="n">esi</span><span class="o">+</span><span class="mi">1</span><span class="n">FF</span><span class="p">]</span>          <span class="o">|</span>
<span class="mi">00401</span><span class="n">A9E</span>  <span class="o">|</span> <span class="n">C1E0</span> <span class="mi">08</span>                     <span class="o">|</span> <span class="n">shl</span> <span class="n">eax</span><span class="p">,</span><span class="mi">8</span>                                    <span class="o">|</span>
<span class="mi">00401</span><span class="n">AA1</span>  <span class="o">|</span> <span class="mi">0</span><span class="n">BD0</span>                        <span class="o">|</span> <span class="k">or</span> <span class="n">edx</span><span class="p">,</span><span class="n">eax</span>                                   <span class="o">|</span>
<span class="mi">00401</span><span class="n">AA3</span>  <span class="o">|</span> <span class="n">C1E1</span> <span class="mi">08</span>                     <span class="o">|</span> <span class="n">shl</span> <span class="n">ecx</span><span class="p">,</span><span class="mi">8</span>                                    <span class="o">|</span>
<span class="mi">00401</span><span class="n">AA6</span>  <span class="o">|</span> <span class="mi">0</span><span class="n">FB68434</span> <span class="n">FE010000</span>           <span class="o">|</span> <span class="n">movzx</span> <span class="n">eax</span><span class="p">,</span><span class="n">byte</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="n">esi</span><span class="o">+</span><span class="mi">1</span><span class="n">FE</span><span class="p">]</span>          <span class="o">|</span>
<span class="mi">00401</span><span class="n">AAE</span>  <span class="o">|</span> <span class="mi">0</span><span class="n">BC8</span>                        <span class="o">|</span> <span class="k">or</span> <span class="n">ecx</span><span class="p">,</span><span class="n">eax</span>                                   <span class="o">|</span>
<span class="mi">00401</span><span class="n">AB0</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">D4424</span> <span class="mi">58</span>                   <span class="o">|</span> <span class="n">lea</span> <span class="n">eax</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">58</span><span class="p">]</span>                <span class="o">|</span>
<span class="mi">00401</span><span class="n">AB4</span>  <span class="o">|</span> <span class="n">C1E1</span> <span class="mi">10</span>                     <span class="o">|</span> <span class="n">shl</span> <span class="n">ecx</span><span class="p">,</span><span class="mi">10</span>                                   <span class="o">|</span>
<span class="mi">00401</span><span class="n">AB7</span>  <span class="o">|</span> <span class="mi">0</span><span class="n">BCA</span>                        <span class="o">|</span> <span class="k">or</span> <span class="n">ecx</span><span class="p">,</span><span class="n">edx</span>                                   <span class="o">|</span>
<span class="mi">00401</span><span class="n">AB9</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">D9424</span> <span class="mi">58010000</span>             <span class="o">|</span> <span class="n">lea</span> <span class="n">edx</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">158</span><span class="p">]</span>               <span class="o">|</span>
<span class="mi">00401</span><span class="n">AC0</span>  <span class="o">|</span> <span class="mi">50</span>                          <span class="o">|</span> <span class="n">push</span> <span class="n">eax</span>                                     <span class="o">|</span>
<span class="mi">00401</span><span class="n">AC1</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">D8424</span> <span class="n">DC000000</span>             <span class="o">|</span> <span class="n">lea</span> <span class="n">eax</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="n">DC</span><span class="p">]</span>                <span class="o">|</span>
<span class="mi">00401</span><span class="n">AC8</span>  <span class="o">|</span> <span class="mi">898</span><span class="n">C24</span> <span class="n">E0010000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="n">E0</span><span class="p">],</span><span class="n">ecx</span>               <span class="o">|</span>
<span class="mi">00401</span><span class="n">ACF</span>  <span class="o">|</span> <span class="mi">50</span>                          <span class="o">|</span> <span class="n">push</span> <span class="n">eax</span>                                     <span class="o">|</span>
<span class="mi">00401</span><span class="n">AD0</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">D8C24</span> <span class="n">E0010000</span>             <span class="o">|</span> <span class="n">lea</span> <span class="n">ecx</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="n">E0</span><span class="p">]</span>               <span class="o">|</span>
<span class="mi">00401</span><span class="n">AD7</span>  <span class="o">|</span> <span class="n">E8</span> <span class="mi">24</span><span class="n">FAFFFF</span>                 <span class="o">|</span> <span class="k">call</span> <span class="o">&lt;</span><span class="n">justre</span><span class="p">.</span><span class="n">sub_401500</span><span class="o">&gt;</span>                     <span class="o">|</span>                                            <span class="err">前面是取，后面是存储，函数用来加密运算</span>
<span class="mi">00401</span><span class="n">ADC</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">B8C24</span> <span class="n">E0010000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">ecx</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="n">E0</span><span class="p">]</span>               <span class="o">|</span>
<span class="mi">00401</span><span class="n">AE3</span>  <span class="o">|</span> <span class="mi">83</span><span class="n">C4</span> <span class="mi">08</span>                     <span class="o">|</span> <span class="k">add</span> <span class="n">esp</span><span class="p">,</span><span class="mi">8</span>                                    <span class="o">|</span>
<span class="mi">00401</span><span class="n">AE6</span>  <span class="o">|</span> <span class="mi">888</span><span class="n">C34</span> <span class="mi">38020000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">byte</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="n">esi</span><span class="o">+</span><span class="mi">238</span><span class="p">],</span><span class="n">cl</span>             <span class="o">|</span>
<span class="mi">00401</span><span class="n">AED</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">BC1</span>                        <span class="o">|</span> <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span><span class="n">ecx</span>                                  <span class="o">|</span>
<span class="mi">00401</span><span class="n">AEF</span>  <span class="o">|</span> <span class="n">C1E8</span> <span class="mi">08</span>                     <span class="o">|</span> <span class="n">shr</span> <span class="n">eax</span><span class="p">,</span><span class="mi">8</span>                                    <span class="o">|</span>
<span class="mi">00401</span><span class="n">AF2</span>  <span class="o">|</span> <span class="mi">888434</span> <span class="mi">39020000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">byte</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="n">esi</span><span class="o">+</span><span class="mi">239</span><span class="p">],</span><span class="n">al</span>             <span class="o">|</span>
<span class="mi">00401</span><span class="n">AF9</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">BC1</span>                        <span class="o">|</span> <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span><span class="n">ecx</span>                                  <span class="o">|</span>
<span class="mi">00401</span><span class="n">AFB</span>  <span class="o">|</span> <span class="n">C1E8</span> <span class="mi">10</span>                     <span class="o">|</span> <span class="n">shr</span> <span class="n">eax</span><span class="p">,</span><span class="mi">10</span>                                   <span class="o">|</span>
<span class="mi">00401</span><span class="n">AFE</span>  <span class="o">|</span> <span class="mi">888434</span> <span class="mi">3</span><span class="n">A020000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">byte</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="n">esi</span><span class="o">+</span><span class="mi">23</span><span class="n">A</span><span class="p">],</span><span class="n">al</span>             <span class="o">|</span>
<span class="mi">00401</span><span class="n">B05</span>  <span class="o">|</span> <span class="n">C1E9</span> <span class="mi">18</span>                     <span class="o">|</span> <span class="n">shr</span> <span class="n">ecx</span><span class="p">,</span><span class="mi">18</span>                                   <span class="o">|</span>
<span class="mi">00401</span><span class="n">B08</span>  <span class="o">|</span> <span class="mi">888</span><span class="n">C34</span> <span class="mi">3</span><span class="n">B020000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">byte</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="n">esi</span><span class="o">+</span><span class="mi">23</span><span class="n">B</span><span class="p">],</span><span class="n">cl</span>             <span class="o">|</span>
<span class="mi">00401</span><span class="n">B0F</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">B8C24</span> <span class="n">DC010000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">ecx</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="n">DC</span><span class="p">]</span>               <span class="o">|</span>
<span class="mi">00401</span><span class="n">B16</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">BC1</span>                        <span class="o">|</span> <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span><span class="n">ecx</span>                                  <span class="o">|</span>
<span class="mi">00401</span><span class="n">B18</span>  <span class="o">|</span> <span class="mi">888</span><span class="n">C34</span> <span class="mi">3</span><span class="n">C020000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">byte</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="n">esi</span><span class="o">+</span><span class="mi">23</span><span class="k">C</span><span class="p">],</span><span class="n">cl</span>             <span class="o">|</span>
<span class="mi">00401</span><span class="n">B1F</span>  <span class="o">|</span> <span class="n">C1E8</span> <span class="mi">08</span>                     <span class="o">|</span> <span class="n">shr</span> <span class="n">eax</span><span class="p">,</span><span class="mi">8</span>                                    <span class="o">|</span>
<span class="mi">00401</span><span class="n">B22</span>  <span class="o">|</span> <span class="mi">888434</span> <span class="mi">3</span><span class="n">D020000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">byte</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="n">esi</span><span class="o">+</span><span class="mi">23</span><span class="n">D</span><span class="p">],</span><span class="n">al</span>             <span class="o">|</span>
<span class="mi">00401</span><span class="n">B29</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">BC1</span>                        <span class="o">|</span> <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span><span class="n">ecx</span>                                  <span class="o">|</span>
<span class="mi">00401</span><span class="n">B2B</span>  <span class="o">|</span> <span class="n">C1E8</span> <span class="mi">10</span>                     <span class="o">|</span> <span class="n">shr</span> <span class="n">eax</span><span class="p">,</span><span class="mi">10</span>                                   <span class="o">|</span>
<span class="mi">00401</span><span class="n">B2E</span>  <span class="o">|</span> <span class="n">C1E9</span> <span class="mi">18</span>                     <span class="o">|</span> <span class="n">shr</span> <span class="n">ecx</span><span class="p">,</span><span class="mi">18</span>                                   <span class="o">|</span>
<span class="mi">00401</span><span class="n">B31</span>  <span class="o">|</span> <span class="mi">888434</span> <span class="mi">3</span><span class="n">E020000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">byte</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="n">esi</span><span class="o">+</span><span class="mi">23</span><span class="n">E</span><span class="p">],</span><span class="n">al</span>             <span class="o">|</span>
<span class="mi">00401</span><span class="n">B38</span>  <span class="o">|</span> <span class="mi">888</span><span class="n">C34</span> <span class="mi">3</span><span class="n">F020000</span>             <span class="o">|</span> <span class="n">mov</span> <span class="n">byte</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="n">esi</span><span class="o">+</span><span class="mi">23</span><span class="n">F</span><span class="p">],</span><span class="n">cl</span>             <span class="o">|</span>
<span class="mi">00401</span><span class="n">B3F</span>  <span class="o">|</span> <span class="mi">83</span><span class="n">C6</span> <span class="mi">08</span>                     <span class="o">|</span> <span class="k">add</span> <span class="n">esi</span><span class="p">,</span><span class="mi">8</span>                                    <span class="o">|</span>
<span class="mi">00401</span><span class="n">B42</span>  <span class="o">|</span> <span class="mi">3</span><span class="n">BF7</span>                        <span class="o">|</span> <span class="n">cmp</span> <span class="n">esi</span><span class="p">,</span><span class="n">edi</span>                                  <span class="o">|</span> <span class="n">edi</span><span class="p">:</span><span class="o">&amp;</span><span class="ss">&quot;D:\\CTF\\Games\\2019\\QWB\\task_JustRe5\\JustRe5\\JustRe.exe&quot;</span>
<span class="mi">00401</span><span class="n">B44</span>  <span class="o">|</span> <span class="mi">0</span><span class="n">F8C</span> <span class="mi">06</span><span class="n">FFFFFF</span>               <span class="o">|</span> <span class="n">jl</span> <span class="n">justre</span><span class="p">.</span><span class="mi">401</span><span class="n">A50</span>                             <span class="o">|</span>
</pre></div>
</td></tr></table>

<p>最后这一部分是对比，而且对比的只有前4组，后两组数是固定不变的</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mi">00401</span><span class="n">B4A</span>  <span class="o">|</span> <span class="n">C74424</span> <span class="mi">10</span> <span class="mi">507</span><span class="n">CA9E6</span>          <span class="o">|</span> <span class="n">mov</span> <span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">10</span><span class="p">],</span><span class="n">E6A97C50</span>           <span class="o">|</span>
<span class="mi">00401</span><span class="n">B52</span>  <span class="o">|</span> <span class="mi">33</span><span class="n">C0</span>                        <span class="o">|</span> <span class="n">xor</span> <span class="n">eax</span><span class="p">,</span><span class="n">eax</span>                                  <span class="o">|</span>
<span class="mi">00401</span><span class="n">B54</span>  <span class="o">|</span> <span class="n">C74424</span> <span class="mi">14</span> <span class="mi">8709</span><span class="n">CEFA</span>          <span class="o">|</span> <span class="n">mov</span> <span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">14</span><span class="p">],</span><span class="n">FACE0987</span>           <span class="o">|</span>
<span class="mi">00401</span><span class="n">B5C</span>  <span class="o">|</span> <span class="n">C74424</span> <span class="mi">18</span> <span class="mi">20</span><span class="n">D50DCF</span>          <span class="o">|</span> <span class="n">mov</span> <span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">18</span><span class="p">],</span><span class="n">CF0DD520</span>           <span class="o">|</span>
<span class="mi">00401</span><span class="n">B64</span>  <span class="o">|</span> <span class="n">C74424</span> <span class="mi">1</span><span class="k">C</span> <span class="mi">90</span><span class="n">BB976C</span>          <span class="o">|</span> <span class="n">mov</span> <span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">1</span><span class="k">C</span><span class="p">],</span><span class="mi">6</span><span class="n">C97BB90</span>           <span class="o">|</span>
<span class="mi">00401</span><span class="n">B6C</span>  <span class="o">|</span> <span class="n">C74424</span> <span class="mi">20</span> <span class="mi">9090</span><span class="n">F6B0</span>          <span class="o">|</span> <span class="n">mov</span> <span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">20</span><span class="p">],</span><span class="n">B0F69090</span>           <span class="o">|</span>
<span class="mi">00401</span><span class="n">B74</span>  <span class="o">|</span> <span class="n">C74424</span> <span class="mi">24</span> <span class="mi">7</span><span class="n">BA6A4E8</span>          <span class="o">|</span> <span class="n">mov</span> <span class="n">dword</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="mi">24</span><span class="p">],</span><span class="n">E8A4A67B</span>           <span class="o">|</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mi">00401</span><span class="n">B80</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">A4C04</span> <span class="mi">10</span>                   <span class="o">|</span> <span class="n">mov</span> <span class="n">cl</span><span class="p">,</span><span class="n">byte</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="n">eax</span><span class="o">+</span><span class="mi">10</span><span class="p">]</span>              <span class="o">|</span>
<span class="mi">00401</span><span class="n">B84</span>  <span class="o">|</span> <span class="mi">3</span><span class="n">A8C04</span> <span class="mi">38020000</span>             <span class="o">|</span> <span class="n">cmp</span> <span class="n">cl</span><span class="p">,</span><span class="n">byte</span> <span class="n">ptr</span> <span class="n">ss</span><span class="p">:[</span><span class="n">esp</span><span class="o">+</span><span class="n">eax</span><span class="o">+</span><span class="mi">238</span><span class="p">]</span>             <span class="o">|</span>
<span class="mi">00401</span><span class="n">B8B</span>  <span class="o">|</span> <span class="mi">75</span> <span class="mi">1</span><span class="n">F</span>                       <span class="o">|</span> <span class="n">jne</span> <span class="n">justre</span><span class="p">.</span><span class="mi">401</span><span class="n">BAC</span>                            <span class="o">|</span>
</pre></div>
</td></tr></table>

<p>根据上面的分析，猜测这是一个64位的分块加密算法，查了一下发现是DES3</p>
<ul>
<li>```
  三重 DES 的加解密方式如下</li>
</ul>
<p>C=Ek3(Dk2(Ek1(P)))C=Ek3(Dk2(Ek1(P)))</p>
<p>P=Dk1(Ek2(Dk3(C)))P=Dk1(Ek2(Dk3(C)))</p>
<p>在选择密钥时，可以有两种方法</p>
<ul>
<li>3 个不同的密钥，k1，k2，k3 互相独立，一共 168 比特。</li>
<li>2 个不同的密钥，k1 与 k2 独立，k3=k1，112 比特。</li>
</ul>
<p>```</p>
<p>最后直接通过pyCrypto模块导入DES3，解出后16位，脚本如下如下</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;AFSAFCEDYCXCXACNDFKDCQXC&quot;</span>
<span class="n">cipher</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span> <span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0xE6</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0xCE</span><span class="p">,</span>
          <span class="mh">0xFA</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0xD5</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span> <span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">]</span>
<span class="n">flag2</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">chr</span><span class="p">,</span> <span class="n">cipher</span><span class="p">))</span>
<span class="n">des3</span> <span class="o">=</span> <span class="n">DES3</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="k">print</span> <span class="n">des3</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">flag2</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>最终脚本：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">from</span> <span class="n">Crypto</span><span class="p">.</span><span class="n">Cipher</span> <span class="n">import</span> <span class="n">DES3</span>
<span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x8B</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">]</span>

<span class="n">aa</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mh">0xFF</span><span class="p">)</span><span class="o">:</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0xB3</span><span class="p">,</span> <span class="mh">0x7B</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="n">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">:</span>
        <span class="n">s1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">i</span>
    <span class="n">key2</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="mi">0</span><span class="n">XFFFFFFF</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">key</span> <span class="o">^</span> <span class="n">key2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mh">0xFFFFFFFF</span><span class="o">:</span>
        <span class="n">aa</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span> <span class="o">^</span> <span class="n">key2</span><span class="p">)</span>
    <span class="k">else</span><span class="o">:</span>
        <span class="n">aa</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xE4</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">]</span>

<span class="n">bb</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mh">0xFF</span><span class="p">)</span><span class="o">:</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x98</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="n">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">:</span>
        <span class="n">s1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">i</span>
    <span class="n">key2</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="mi">0</span><span class="n">XFFFFFFF</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">key</span> <span class="o">^</span> <span class="n">key2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mh">0xFFFFFFFF</span><span class="o">:</span>
        <span class="n">bb</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span> <span class="o">^</span> <span class="n">key2</span><span class="p">)</span>
    <span class="k">else</span><span class="o">:</span>
        <span class="n">bb</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="n">aa</span><span class="p">))</span><span class="o">:</span>
    <span class="k">if</span> <span class="n">aa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="n">and</span> <span class="n">bb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">:</span>
        <span class="k">if</span> <span class="n">bb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">aa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="o">:</span>
            <span class="n">print</span> <span class="n">hex</span><span class="p">(</span><span class="n">aa</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">break</span>

<span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xE4</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">]</span>
<span class="n">s1</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x98</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">]</span>
<span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">key2</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">print</span> <span class="n">hex</span><span class="p">((</span><span class="n">key</span> <span class="o">^</span> <span class="n">bb</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">key2</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span> <span class="o">^</span> <span class="n">bb</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">key2</span>

<span class="n">key</span> <span class="o">=</span> <span class="s">&quot;AFSAFCEDYCXCXACNDFKDCQXC&quot;</span>
<span class="n">cipher</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span> <span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0xE6</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0xCE</span><span class="p">,</span>
          <span class="mh">0xFA</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0xD5</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span> <span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">]</span>
<span class="n">flag2</span> <span class="o">=</span> <span class="err">&#39;&#39;</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">map</span><span class="p">(</span><span class="n">chr</span><span class="p">,</span> <span class="n">cipher</span><span class="p">))</span>
<span class="n">des3</span> <span class="o">=</span> <span class="n">DES3</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="n">print</span> <span class="n">hex</span><span class="p">(</span><span class="n">aa</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">2</span><span class="o">:</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="n">hex</span><span class="p">(</span><span class="n">a</span><span class="p">)[</span><span class="mi">2</span><span class="o">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="n">des3</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">flag2</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>得flag{13242248150dcc509a6f75849b}</p>
<h2 id="_ad">强网先锋_AD</h2>
<p>题目：<a href="https://raw.githubusercontent.com/Alikas0/CTF/master/challenges/2019/QWB/JustRe/JustRe.rar%E5%BC%BA%E7%BD%91%E5%85%88%E5%B3%B0/qwb2019_misc.tar.gz">强网先锋_AD</a> </p>
<p>这道题就是一道水题0.0</p>
<p>下载后拖进IDA里打开，直接找到mian函数</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">main</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">a2</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">a3</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">char</span> <span class="n">v4</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span> <span class="c1">// [rsp+0h] [rbp-150h]</span>
  <span class="kt">char</span> <span class="n">key</span><span class="p">[</span><span class="mi">45</span><span class="p">];</span> <span class="c1">// [rsp+80h] [rbp-D0h]</span>
  <span class="kr">__int64</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// [rsp+B0h] [rbp-A0h]</span>
  <span class="kr">__int64</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// [rsp+B8h] [rbp-98h]</span>
  <span class="kr">__int64</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// [rsp+C0h] [rbp-90h]</span>
  <span class="kr">__int16</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// [rsp+C8h] [rbp-88h]</span>
  <span class="kt">char</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// [rsp+D0h] [rbp-80h]</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">v11</span><span class="p">;</span> <span class="c1">// [rsp+140h] [rbp-10h]</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+14Ch] [rbp-4h]</span>

  <span class="n">puts</span><span class="p">(</span><span class="s">&quot;=== Strong Network Pioneer === </span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="n">__isoc99_scanf</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v10</span><span class="p">);</span>
  <span class="n">v6</span> <span class="o">=</span> <span class="mi">7953769703030221169LL</span><span class="p">;</span>
  <span class="n">v7</span> <span class="o">=</span> <span class="mi">7954876941086586983LL</span><span class="p">;</span>
  <span class="n">v8</span> <span class="o">=</span> <span class="mi">7956005061827062375LL</span><span class="p">;</span>
  <span class="n">v9</span> <span class="o">=</span> <span class="mi">105</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5A</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x6D</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x78</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">104</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">90</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">51</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">116</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">116</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mi">89</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="mi">87</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">90</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="mi">104</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="mi">97</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="mi">51</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="mi">86</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="mi">104</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="mi">97</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="mi">87</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="mi">120</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="mi">104</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="mi">97</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="mi">88</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="mi">70</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">=</span> <span class="mi">112</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">=</span> <span class="mi">89</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">=</span> <span class="mi">87</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">=</span> <span class="mi">53</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">=</span> <span class="mi">107</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span> <span class="o">=</span> <span class="mi">89</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span> <span class="o">=</span> <span class="mi">87</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span> <span class="o">=</span> <span class="mi">57</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">=</span> <span class="mi">105</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="mi">102</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span> <span class="o">=</span> <span class="mi">81</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">34</span><span class="p">]</span> <span class="o">=</span> <span class="mi">61</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">35</span><span class="p">]</span> <span class="o">=</span> <span class="mi">61</span><span class="p">;</span>
  <span class="n">v11</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">v10</span><span class="p">;</span>
  <span class="n">sub_4005B7</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v10</span><span class="p">,</span> <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="n">v4</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">44</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">puts</span><span class="p">(</span><span class="s">&quot;you&#39;re not</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
      <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">&quot;yes, you are!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>最下面的循环是判断，也就是说我们输入的v4要和key相等</p>
<p>进入sub_4005B7</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">sub_4005B7</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">a1</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a2</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// ST18_4</span>
  <span class="kt">int</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">int</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">int</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// [rsp+10h] [rbp-10h]</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v11</span><span class="p">;</span> <span class="c1">// [rsp+17h] [rbp-9h]</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v12</span><span class="p">;</span> <span class="c1">// [rsp+17h] [rbp-9h]</span>
  <span class="kt">int</span> <span class="n">v13</span><span class="p">;</span> <span class="c1">// [rsp+18h] [rbp-8h]</span>
  <span class="kt">int</span> <span class="n">v14</span><span class="p">;</span> <span class="c1">// [rsp+18h] [rbp-8h]</span>
  <span class="kt">int</span> <span class="n">v15</span><span class="p">;</span> <span class="c1">// [rsp+18h] [rbp-8h]</span>
  <span class="kt">int</span> <span class="n">v16</span><span class="p">;</span> <span class="c1">// [rsp+1Ch] [rbp-4h]</span>

  <span class="n">v16</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v13</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v10</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">a1</span><span class="p">);</span>
  <span class="k">while</span> <span class="p">(</span> <span class="n">v16</span> <span class="o">&lt;</span> <span class="n">v10</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v2</span> <span class="o">=</span> <span class="n">v13</span><span class="p">;</span>
    <span class="n">v14</span> <span class="o">=</span> <span class="n">v13</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="n">v2</span><span class="p">)</span> <span class="o">=</span> <span class="n">base64</span><span class="p">[(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">a1</span><span class="p">[</span><span class="n">v16</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">];</span>
    <span class="n">v11</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">*</span> <span class="n">a1</span><span class="p">[</span><span class="n">v16</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x30</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v10</span> <span class="o">&lt;=</span> <span class="n">v16</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">v4</span> <span class="o">=</span> <span class="n">v14</span><span class="p">;</span>
      <span class="n">v5</span> <span class="o">=</span> <span class="n">v14</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
      <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="n">v4</span><span class="p">)</span> <span class="o">=</span> <span class="n">base64</span><span class="p">[</span><span class="n">v11</span><span class="p">];</span>
      <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v5</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">61</span><span class="p">;</span>
      <span class="n">v6</span> <span class="o">=</span> <span class="n">v5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
      <span class="n">v13</span> <span class="o">=</span> <span class="n">v5</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
      <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v6</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">61</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">v3</span> <span class="o">=</span> <span class="n">v14</span><span class="p">;</span>
    <span class="n">v15</span> <span class="o">=</span> <span class="n">v14</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="n">v3</span><span class="p">)</span> <span class="o">=</span> <span class="n">base64</span><span class="p">[((</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">a1</span><span class="p">[</span><span class="n">v16</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">v11</span><span class="p">];</span>
    <span class="n">v12</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a1</span><span class="p">[</span><span class="n">v16</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x3C</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v10</span> <span class="o">&lt;=</span> <span class="n">v16</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="n">v15</span><span class="p">)</span> <span class="o">=</span> <span class="n">base64</span><span class="p">[</span><span class="n">v12</span><span class="p">];</span>
      <span class="n">v8</span> <span class="o">=</span> <span class="n">v15</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
      <span class="n">v13</span> <span class="o">=</span> <span class="n">v15</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
      <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v8</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">61</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="n">v15</span><span class="p">)</span> <span class="o">=</span> <span class="n">base64</span><span class="p">[((</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">a1</span><span class="p">[</span><span class="n">v16</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">v12</span><span class="p">];</span>
    <span class="n">v7</span> <span class="o">=</span> <span class="n">v15</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">v13</span> <span class="o">=</span> <span class="n">v15</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
    <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="n">v7</span><span class="p">)</span> <span class="o">=</span> <span class="n">base64</span><span class="p">[</span><span class="n">a1</span><span class="p">[</span><span class="n">v16</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">];</span>
    <span class="n">v16</span> <span class="o">+=</span> <span class="mi">3</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v13</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>看着很熟悉....直接就能找到base64加密table表</p>
<p><img alt="1558933633691" src="https://raw.githubusercontent.com/Alikas0/files/master/img/1558933633691.png" /></p>
<p>写个脚本跑一下，flag即出</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">import</span> <span class="n">base64</span>
<span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">45</span><span class="p">)]</span>

<span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5A</span>
<span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x6D</span>
<span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x78</span>
<span class="n">key</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">104</span>
<span class="n">key</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">90</span>
<span class="n">key</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">51</span>
<span class="n">key</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">116</span>
<span class="n">key</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">116</span>
<span class="n">key</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mi">89</span>
<span class="n">key</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="mi">87</span>
<span class="n">key</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">90</span>
<span class="n">key</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="mi">104</span>
<span class="n">key</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="mi">97</span>
<span class="n">key</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="mi">51</span>
<span class="n">key</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="mi">86</span>
<span class="n">key</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="mi">104</span>
<span class="n">key</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="mi">97</span>
<span class="n">key</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="mi">87</span>
<span class="n">key</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="mi">120</span>
<span class="n">key</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="mi">104</span>
<span class="n">key</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="mi">97</span>
<span class="n">key</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="mi">88</span>
<span class="n">key</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="mi">70</span>
<span class="n">key</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">=</span> <span class="mi">112</span>
<span class="n">key</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">=</span> <span class="mi">89</span>
<span class="n">key</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">=</span> <span class="mi">87</span>
<span class="n">key</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">=</span> <span class="mi">53</span>
<span class="n">key</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">=</span> <span class="mi">107</span>
<span class="n">key</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span> <span class="o">=</span> <span class="mi">89</span>
<span class="n">key</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span> <span class="o">=</span> <span class="mi">87</span>
<span class="n">key</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span> <span class="o">=</span> <span class="mi">57</span>
<span class="n">key</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">=</span> <span class="mi">105</span>
<span class="n">key</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="mi">102</span>
<span class="n">key</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span> <span class="o">=</span> <span class="mi">81</span>
<span class="n">key</span><span class="p">[</span><span class="mi">34</span><span class="p">]</span> <span class="o">=</span> <span class="mi">61</span>
<span class="n">key</span><span class="p">[</span><span class="mi">35</span><span class="p">]</span> <span class="o">=</span> <span class="mi">61</span>

<span class="n">flag</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>

<span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="n">key</span><span class="p">))</span><span class="o">:</span>
    <span class="n">flag</span> <span class="o">+=</span> <span class="n">chr</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="n">flag</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>

<span class="n">print</span> <span class="n">flag</span>
</pre></div>
</td></tr></table>

<p>flag{mafakuailaiqiandaob}</p>
<h2 id="webassembly">webassembly</h2>
<p>题目：<a href="https://raw.githubusercontent.com/Alikas0/CTF/master/challenges/2019/QWB/JustRe/JustRe.rarwebassembly/webassembly5.tar">webassembly</a></p>
<p>这是我第一次接触wasm，记录一下0.0</p>
<p>题目下下来只有三个文件，分别是<code>.js</code> , <code>.wasm</code>,<code>.html</code></p>
<p>wasm介绍就不在这里介绍了，有兴趣可以到这里看看</p>
<p>wasm就是一堆二进制文件，就很头秃。但可以用<a href="https://github.com/WebAssembly/wabt">wabt工具</a>转成<code>.c</code>和<code>.h</code>文件</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="err">$</span><span class="p">.</span><span class="o">/</span><span class="n">wasm2c</span> <span class="n">webassembly</span><span class="p">.</span><span class="n">wasm</span> <span class="o">-</span><span class="n">o</span> <span class="n">webassembly</span><span class="p">.</span><span class="k">c</span>
</pre></div>
</td></tr></table>

<p>不过还是看不懂，代码行数贼恐怖18567行..............后来Apeng大佬提供了一种优化方法：用gcc编译后在用ida反编译</p>
<p>将之前反编译出来的wasm.c，wasm.h，以及wabt项目内的wasm-rt.h，wasm-rt-impl.c，wasm-rt-impl.h三个文件放到同一个文件夹。</p>
<p>直接gcc wasm.c会报错，因为很多wasm的函数没有具体的实现。但是我们可以只编译不链接，我们关心的只是程序本身的逻辑，不需要真正编译出能运行的elf来。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="err">$</span><span class="n">gcc</span> <span class="o">-</span><span class="k">c</span> <span class="n">wasm</span><span class="p">.</span><span class="k">c</span> <span class="o">-</span><span class="n">o</span> <span class="n">wasm</span><span class="p">.</span><span class="n">o</span>
</pre></div>
</td></tr></table>

<p>得到的还未连接的elf文件wasm.o</p>
<p>现在就可以丢进ida来分析了，比之前的wasm.c友好很多。</p>
<p>分析出来是，XTEA加密，解密脚本(Apeng大佬太强了0.0)如下：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>#<span class="k">include</span> <span class="s2">&quot;</span><span class="s">pch.h</span><span class="s2">&quot;</span>
#<span class="k">include</span> <span class="o">&lt;</span><span class="nv">iostream</span><span class="o">&gt;</span>
<span class="nv">using</span> <span class="nv">namespace</span> <span class="nv">std</span><span class="c1">;</span>

<span class="nv">void</span> <span class="nv">encipher</span><span class="ss">(</span><span class="nv">unsigned</span> <span class="nv">int</span> <span class="nv">num_rounds</span>, <span class="nv">uint32_t</span> <span class="nv">v</span>[<span class="mi">2</span>], <span class="nv">uint32_t</span> <span class="nv">const</span> <span class="nv">key</span>[<span class="mi">4</span>]<span class="ss">)</span> {
    <span class="nv">unsigned</span> <span class="nv">int</span> <span class="nv">i</span><span class="c1">;</span>
    <span class="nv">uint32_t</span> <span class="nv">v0</span> <span class="o">=</span> <span class="nv">v</span>[<span class="mi">0</span>], <span class="nv">v1</span> <span class="o">=</span> <span class="nv">v</span>[<span class="mi">1</span>], <span class="nv">sum</span> <span class="o">=</span> <span class="mi">0</span>, <span class="nv">delta</span> <span class="o">=</span> <span class="mi">0</span><span class="nv">x9E3779B9</span><span class="c1">;</span>
    <span class="k">for</span> <span class="ss">(</span><span class="nv">i</span> <span class="o">=</span> <span class="mi">0</span><span class="c1">; i &lt; num_rounds; i++) {</span>
        <span class="nv">v0</span> <span class="o">+=</span> <span class="ss">(((</span><span class="nv">v1</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="ss">)</span> <span class="o">^</span> <span class="ss">(</span><span class="nv">v1</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="ss">))</span> <span class="o">+</span> <span class="nv">v1</span><span class="ss">)</span> <span class="o">^</span> <span class="ss">(</span><span class="nv">sum</span> <span class="o">+</span> <span class="nv">key</span>[<span class="nv">sum</span> <span class="o">&amp;</span> <span class="mi">3</span>]<span class="ss">)</span><span class="c1">;</span>
        <span class="nv">sum</span> <span class="o">+=</span> <span class="nv">delta</span><span class="c1">;</span>
        <span class="nv">v1</span> <span class="o">+=</span> <span class="ss">(((</span><span class="nv">v0</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="ss">)</span> <span class="o">^</span> <span class="ss">(</span><span class="nv">v0</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="ss">))</span> <span class="o">+</span> <span class="nv">v0</span><span class="ss">)</span> <span class="o">^</span> <span class="ss">(</span><span class="nv">sum</span> <span class="o">+</span> <span class="nv">key</span>[<span class="ss">(</span><span class="nv">sum</span> <span class="o">&gt;&gt;</span> <span class="mi">11</span><span class="ss">)</span> <span class="o">&amp;</span> <span class="mi">3</span>]<span class="ss">)</span><span class="c1">;</span>
    }
    <span class="nv">v</span>[<span class="mi">0</span>] <span class="o">=</span> <span class="nv">v0</span><span class="c1">; v[1] = v1;</span>
}


<span class="nv">void</span> <span class="nv">decipher</span><span class="ss">(</span><span class="nv">unsigned</span> <span class="nv">int</span> <span class="nv">num_rounds</span>, <span class="nv">uint32_t</span> <span class="nv">v</span>[<span class="mi">2</span>], <span class="nv">uint32_t</span> <span class="nv">const</span> <span class="nv">key</span>[<span class="mi">4</span>]<span class="ss">)</span> {
    <span class="nv">unsigned</span> <span class="nv">int</span> <span class="nv">i</span><span class="c1">;</span>
    <span class="nv">uint32_t</span> <span class="nv">v0</span> <span class="o">=</span> <span class="nv">v</span>[<span class="mi">0</span>], <span class="nv">v1</span> <span class="o">=</span> <span class="nv">v</span>[<span class="mi">1</span>], <span class="nv">delta</span> <span class="o">=</span> <span class="mi">0</span><span class="nv">x9E3779B9</span>, <span class="nv">sum</span> <span class="o">=</span> <span class="nv">delta</span> <span class="o">*</span> <span class="nv">num_rounds</span><span class="c1">;</span>
    <span class="k">for</span> <span class="ss">(</span><span class="nv">i</span> <span class="o">=</span> <span class="mi">0</span><span class="c1">; i &lt; num_rounds; i++) {</span>
        <span class="nv">v1</span> <span class="o">-=</span> <span class="ss">(((</span><span class="nv">v0</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="ss">)</span> <span class="o">^</span> <span class="ss">(</span><span class="nv">v0</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="ss">))</span> <span class="o">+</span> <span class="nv">v0</span><span class="ss">)</span> <span class="o">^</span> <span class="ss">(</span><span class="nv">sum</span> <span class="o">+</span> <span class="nv">key</span>[<span class="ss">(</span><span class="nv">sum</span> <span class="o">&gt;&gt;</span> <span class="mi">11</span><span class="ss">)</span> <span class="o">&amp;</span> <span class="mi">3</span>]<span class="ss">)</span><span class="c1">;</span>
        <span class="nv">sum</span> <span class="o">-=</span> <span class="nv">delta</span><span class="c1">;</span>
        <span class="nv">v0</span> <span class="o">-=</span> <span class="ss">(((</span><span class="nv">v1</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="ss">)</span> <span class="o">^</span> <span class="ss">(</span><span class="nv">v1</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="ss">))</span> <span class="o">+</span> <span class="nv">v1</span><span class="ss">)</span> <span class="o">^</span> <span class="ss">(</span><span class="nv">sum</span> <span class="o">+</span> <span class="nv">key</span>[<span class="nv">sum</span> <span class="o">&amp;</span> <span class="mi">3</span>]<span class="ss">)</span><span class="c1">;</span>
    }
    <span class="nv">v</span>[<span class="mi">0</span>] <span class="o">=</span> <span class="nv">v0</span><span class="c1">; v[1] = v1;</span>
}

<span class="nv">int</span> <span class="nv">main</span><span class="ss">()</span>
{

    <span class="nv">int</span> <span class="nv">i</span><span class="c1">;</span>
    <span class="nv">unsigned</span> <span class="nv">int</span> <span class="nv">v</span>[<span class="mi">10</span>] <span class="o">=</span> { <span class="mi">2586051617</span><span class="nv">L</span>, <span class="mi">2764128737</span><span class="nv">L</span>, <span class="mi">1835204653</span>, <span class="mi">2601945884</span><span class="nv">L</span>, <span class="mi">95579550</span>, <span class="mi">993221996</span>, <span class="mi">1624609160</span>, <span class="mi">781843991</span>, <span class="mi">879125044</span>,<span class="mi">0</span><span class="nv">x7D61</span> }<span class="c1">;</span>
    <span class="nv">unsigned</span> <span class="nv">int</span> <span class="nv">k</span>[<span class="mi">4</span>] <span class="o">=</span> { <span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span> }<span class="c1">;</span>
    <span class="k">for</span> <span class="ss">(</span><span class="nv">i</span> <span class="o">=</span> <span class="mi">0</span><span class="c1">; i &lt; 8; i += 2)</span>
        <span class="nv">decipher</span><span class="ss">(</span><span class="mi">32</span>, <span class="o">&amp;</span><span class="nv">v</span>[<span class="nv">i</span>], <span class="nv">k</span><span class="ss">)</span><span class="c1">;</span>
    <span class="nv">cout</span> <span class="o">&lt;&lt;</span> <span class="ss">(</span><span class="nv">char</span> <span class="o">*</span><span class="ss">)</span><span class="nv">v</span> <span class="o">&lt;&lt;</span> <span class="nv">endl</span><span class="c1">;</span>
}
</pre></div>
</td></tr></table>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../2019starctf/" title="2019 *CTF" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  上一页
                </span>
                2019 *CTF
              </span>
            </div>
          </a>
        
        
          <a href="../../exams/buuctf/introduction/" title="简介" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  下一页
                </span>
                简介
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/Alikas0" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://t.me/Alikas" class="md-footer-social__link fa fa-telegram"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.245445c6.js"></script>
      
        
        
          
          <script src="../../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../../../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../../../assets/javascripts/lunr/lunr.ja.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
        <script src="../../../js/extra.js"></script>
      
    
  </body>
</html>